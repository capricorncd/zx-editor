{"version":3,"file":"zx-editor.js","sources":["zx-editor.esm.js"],"sourcesContent":["/*!\n * zx-editor v3.1.0\n * https://github.com/capricorncd/zx-editor\n * Released under the MIT License\n * Released on: Tue May 10 2022 22:22:39 GMT+0900 (Japan Standard Time)\n * Copyright © 2018-present, capricorncd\n */\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/05 14:47:02 (GMT+0900)\n */\n/**\n * to snake case\n * helloWorld => hello-world\n * helloWorld => hello_world\n * helloWorld => hello world\n * @param str\n * @param connectSymbol word connect symbol\n */\nconst toSnakeCase = (str, connectSymbol = '-') => {\n    return str.replace(/[A-Z]/g, (s) => `${connectSymbol}${s.toLowerCase()}`);\n};\n/**\n * to camel case\n * hello_world => helloWorld\n * hello-world => helloWorld\n * hello world => helloWorld\n * @param str\n */\nconst toCamelCase = (str) => {\n    return str.replace(/[-_\\s](\\w)/g, (_, s) => s.toUpperCase());\n};\nconst slice = (arrLike, offset = 0) => {\n    return Array.prototype.slice.call(arrLike, offset);\n};\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/05 10:55:25 (GMT+0900)\n */\nconst $ = (selector, doc = document) => {\n    if (selector instanceof HTMLElement)\n        return selector;\n    return doc.querySelector(selector);\n};\n// export const $$ = <T extends HTMLElement>(selector: string, doc: Document | HTMLElement = document): T[] => {\n//   return Array.prototype.slice.call(doc.querySelectorAll(selector), 0)\n// }\nconst createElement = (tag, attrs = {}, innerHTML) => {\n    const el = document.createElement(tag);\n    for (const [key, val] of Object.entries(attrs)) {\n        el.setAttribute(key, val);\n    }\n    if (innerHTML)\n        el.innerHTML = innerHTML;\n    return el;\n};\n/**\n * 将样式对象转换为字符串\n * {color: 'red', fontSize: '16px'} => 'color:red;font-size:16px'\n * @param data\n * @param extendStyles\n */\nconst createStyles = (data, extendStyles) => {\n    if (extendStyles) {\n        // 防止extendStyles存在snake的属性，不能成功覆盖旧样式\n        // data['lineHeight'] = 1.5, extendStyles['line-height'] = ''\n        for (const [key, value] of Object.entries(extendStyles)) {\n            data[toCamelCase(key)] = value;\n        }\n    }\n    const arr = [];\n    for (const [key, value] of Object.entries(data)) {\n        if (value === '' || typeof value === 'undefined' || value === null)\n            continue;\n        arr.push(`${toSnakeCase(key)}:${value}`);\n    }\n    return arr.join(';');\n};\nconst replaceHtmlTag = (input, oldNodeName, newNodeName) => {\n    return input.replace(RegExp(\"(^<\" + oldNodeName + \")|(\" + oldNodeName + \">$)\", \"gi\"), (match) => match.toUpperCase().replace(oldNodeName, newNodeName.toLowerCase()));\n};\nconst isUlElement = (el) => {\n    return /UL|OL/.test(el.nodeName);\n};\n/**\n * is <br> section\n * <section><br></section>\n * @param el\n */\nconst isBrSection = (el) => {\n    if (!el)\n        return false;\n    const nodes = slice(el.childNodes);\n    return nodes.length === 1 && nodes[0].nodeName === 'BR';\n};\nconst getStyles = (el) => {\n    const style = el.getAttribute('style') || '';\n    return style.split(/\\s?;\\s?/).reduce((prev, s) => {\n        const [key, val] = s.split(/\\s?:\\s?/);\n        prev[toCamelCase(key)] = val;\n        return prev;\n    }, {});\n};\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/05 11:55:07 (GMT+0900)\n */\nconst CLASS_NAME_EDITOR = 'zx-editor';\nconst CLASS_NAME_CONTENT = `${CLASS_NAME_EDITOR}__content-wrapper`;\n\nconst ALLOWED_NODE_NAMES = ['SECTION', 'H1', 'H2', 'H3', 'H4', 'H5', 'BLOCKQUOTE', 'UL', 'OL'];\nconst REPLACE_NODE_LIST = [\n    'DIV',\n    'P',\n    'ARTICLE',\n    'ASIDE',\n    'DETAILS',\n    'SUMMARY',\n    'FOOTER',\n    'HEADER',\n    'MAIN',\n    'NAV',\n    'SECTION',\n    'H1',\n    'H2',\n    'H3',\n    'H4',\n    'H5',\n    'H6',\n    'BLOCKQUOTE',\n];\nconst DEF_OPTIONS = {\n    // 内容是否可以被编辑\n    editable: true,\n    // 编辑器输入内容绝对定位\n    // fixed: false,\n    // editor min height\n    minHeight: '50vh',\n    // style\n    placeholder: 'Enter...',\n    placeholderColor: '',\n    lineHeight: 1.5,\n    allowedNodeNames: ALLOWED_NODE_NAMES,\n    // paragraph tail spacing, default 10px\n    // paragraphTailSpacing: '',\n    caretColor: '',\n    textColor: '',\n    // iphone会自动移动，难控制\n    // 光标所在行距页面顶部的距离30px\n    cursorOffsetTop: 30,\n    // 自定义粘贴处理函数\n    customPasteHandler: undefined,\n    /**\n     * ******************************\n     * toolbar options\n     * ******************************\n     */\n    // Has the toolbar been fixed?\n    toolbarBeenFixed: true,\n    toolbarHeight: 50,\n    // buttons name, and order\n    toolbarButtons: ['select-picture', 'text-style'],\n    /**\n     * ******************************\n     * image options\n     * ******************************\n     */\n    // customize Picture Handler\n    // customPictureHandler: undefined,\n    // image max width\n    imageMaxWidth: 720,\n    // image max size, unit Kib, default 20M\n    imageMaxSize: 20480,\n    // template\n    imageSectionTemp: `<section class=\"child-is-picture\"><img src=\"{url}\" loading=\"lazy\"></section>`,\n    // GIF pictures are not processed\n    ignoreGif: true,\n    // Force the width/height of the picture, even if the width/height of the picture\n    // is smaller than the target width/height\n    forceImageResize: false,\n    /**\n     * ******************************\n     * text style options\n     * ******************************\n     */\n    // text style, value ['#333', '#f00', ...]\n    // textStyleColors: undefined,\n    textStyleTitle: 'Set Style',\n    textStyleHeadLeftBtnText: 'Clear style',\n    textStyleHeadAlign: 'center',\n    /**\n     * ******************************\n     * color options\n     * ******************************\n     */\n    mainColor: '',\n    // border color\n    borderColor: '',\n};\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/05 10:32:12 (GMT+0900)\n */\nconst NODE_NAME_SECTION = 'SECTION';\nconst NODE_NAME_BR = 'BR';\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/09 21:12:46 (GMT+0900)\n */\n/**\n * init editor dom\n */\nconst initEditorDom = () => {\n    const el = createElement('div', {\n        class: CLASS_NAME_EDITOR,\n    });\n    return el;\n};\nconst createPseudoClassBefore = (placeholder) => {\n    // 伪类content\n    const beforeStyle = `.${CLASS_NAME_EDITOR} .${CLASS_NAME_CONTENT}.is-empty:before{content:'${placeholder}' !important;`;\n    const style = createElement('style', { type: 'text/css' }, beforeStyle);\n    $('head')?.append(style);\n};\n/**\n * init content dom\n * @param options\n */\nconst initContentDom = (options) => {\n    const contentStyles = {\n        lineHeight: options.lineHeight,\n        minHeight: options.minHeight,\n        position: 'relative',\n        overflowY: 'scroll',\n        outline: 'none',\n        // 用户自定义样式优先\n        ...options.styles,\n        // placeholder\n        '--placeholder-color': options.placeholderColor,\n        '--line-height': options.lineHeight,\n    };\n    createPseudoClassBefore(options.placeholder);\n    if (options.caretColor)\n        contentStyles.caretColor = options.caretColor;\n    if (options.textColor)\n        contentStyles.color = options.textColor;\n    const contentAttrs = {\n        class: `${CLASS_NAME_CONTENT} is-empty`,\n        style: createStyles(contentStyles),\n    };\n    if (options.editable)\n        contentAttrs.contenteditable = 'true';\n    const el = createElement('div', contentAttrs);\n    el.innerHTML = `<section><br></section>`;\n    // return\n    return el;\n};\n/**\n *\n * @param input\n * @param tagName\n */\nconst changeNodeName = (input, tagName = NODE_NAME_SECTION) => {\n    const oldNodeName = input.nodeName;\n    const newNodeName = tagName.toUpperCase();\n    if (oldNodeName === newNodeName)\n        return input;\n    const el = createElement(tagName);\n    const parent = input.parentElement;\n    let newEl;\n    // LI元素处理：被修改的元素为UL/OL的内部元素\n    if (oldNodeName === 'LI' && isUlElement(parent)) {\n        // 替换当前LI元素标签为新元素标签\n        el.innerHTML = replaceHtmlTag(input.outerHTML, oldNodeName, newNodeName);\n        // 获取新元素\n        newEl = el.firstChild;\n        // 有多个LI元素\n        if (parent.childElementCount > 1) {\n            // 当前LI元素为UL的第一个元素\n            if (parent.firstElementChild === input) {\n                // 将新元素移动至UL/OL前面\n                parent.parentElement?.insertBefore(newEl, parent);\n            }\n            // 当前LI元素为UL的最后一个元素\n            else if (parent.lastElementChild === input) {\n                const parentNext = parent.parentElement?.nextElementSibling;\n                // 下一个兄弟元素存在，添加至下一个兄弟元素前面\n                if (parentNext) {\n                    parentNext.parentElement?.insertBefore(newEl, parentNext);\n                }\n                else {\n                    // 下一个兄弟元素不存在，添加至内容尾部\n                    parent.parentElement?.append(newEl);\n                }\n            }\n            // 当前LI元素为UL中间的一个元素，拆分当前UL/OL\n            else {\n                const elList = slice(parent.children);\n                const prevEl = createElement(parent.nodeName);\n                let tempEl = elList.shift();\n                while (tempEl) {\n                    if (tempEl === input)\n                        break;\n                    prevEl.append(tempEl);\n                    tempEl = elList.shift();\n                }\n                parent.parentElement?.insertBefore(prevEl, parent);\n                // 将新元素插入到当前UL/OL元素前面\n                parent.parentElement?.insertBefore(newEl, parent);\n                // 删除被替换的对象元素\n                parent.removeChild(input);\n            }\n        }\n        // 只有一个LI元素\n        else {\n            // 将新元素移动至UL/OL前面\n            parent.parentElement?.insertBefore(newEl, parent);\n            // 移除UL/OL空元素\n            parent.parentElement?.removeChild(parent);\n        }\n        return newEl;\n    }\n    if (REPLACE_NODE_LIST.includes(oldNodeName)) {\n        // change to ul, ol\n        if (/UL|OL/.test(newNodeName)) {\n            const prev = input.previousElementSibling;\n            const next = input.nextElementSibling;\n            if (prev && isUlElement(prev)) {\n                el.innerHTML = replaceHtmlTag(input.outerHTML, oldNodeName, 'li');\n                newEl = el.firstChild;\n                prev.append(newEl);\n                parent?.removeChild(input);\n                // parent的下一个元素也为UL/OL元素，将其合并\n                if (next && next.nodeName === prev.nodeName) {\n                    const nextEls = slice(next.children);\n                    prev.append(...nextEls);\n                    next.parentElement?.removeChild(next);\n                }\n            }\n            else if (next && isUlElement(next)) {\n                el.innerHTML = replaceHtmlTag(input.outerHTML, oldNodeName, 'li');\n                newEl = el.firstChild;\n                next.insertBefore(newEl, next.firstElementChild);\n                parent?.removeChild(input);\n                // parent的上一个元素也为UL/OL元素，将其合并\n                // 不可能发生never\n            }\n            else {\n                // 替换当前元素为UL/OL\n                newEl = el;\n                el.innerHTML = replaceHtmlTag(input.outerHTML, oldNodeName, 'li');\n                parent?.replaceChild(newEl, input);\n            }\n        }\n        else {\n            el.innerHTML = replaceHtmlTag(input.outerHTML, oldNodeName, newNodeName);\n            newEl = el.firstChild;\n            parent?.replaceChild(newEl, input);\n        }\n        return newEl;\n    }\n    el.append(input.cloneNode(true));\n    parent?.replaceChild(el, input);\n    return el;\n};\nconst checkIsEmpty = (el) => {\n    if (el.children.length <= 1 && isBrSection(el.children[0])) {\n        el.classList.add('is-empty');\n    }\n    else {\n        el.classList.remove('is-empty');\n    }\n};\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/07 10:33:02 (GMT+0900)\n */\nclass CursorClass {\n    rootElement;\n    timer;\n    constructor(rootElement) {\n        this.rootElement = rootElement;\n        this.timer = null;\n        // init range\n        const el = rootElement.lastElementChild;\n        if (el)\n            this.setRange(el, el.textContent?.length);\n    }\n    getRange() {\n        try {\n            // @ts-ignore\n            return window.getSelection()?.getRangeAt(0);\n        }\n        catch (e) {\n            // ..\n        }\n        return new Range();\n    }\n    /**\n     * 获取当前元素的最后一个无子节点的节点\n     * @param el\n     * @private\n     */\n    _getLastNode(el) {\n        let node = el;\n        while (node.lastChild) {\n            node = node.lastChild;\n        }\n        return node;\n    }\n    setRange(el, offset) {\n        const range = this.getRange();\n        // remove all range object\n        const selection = window.getSelection();\n        if (selection)\n            selection.removeAllRanges();\n        // el: '<section>inner text.</section>'\n        // let targetNode = el.childNodes[el.childNodes.length - 1] || el\n        // // check img/video/audio\n        // if (/IMG|VIDEO|AUDIO/.test(targetNode.nodeName)) {\n        //   offset = 1\n        //   // get parentNode, can't set offset = 1 of IMG node.\n        //   targetNode = targetNode.parentNode as HTMLElement\n        // }\n        const targetNode = this._getLastNode(el);\n        if (typeof offset === 'undefined') {\n            offset = targetNode.textContent?.length ?? 0;\n        }\n        range.setStart(targetNode, offset);\n        // cursor start and end position is collapse\n        range.collapse(true);\n        this._clearTimeout();\n        // 延时执行，键盘自动收起后再触发focus\n        // @ts-ignore\n        this.timer = setTimeout(() => {\n            // 插入新的光标对象\n            selection?.addRange(range);\n        }, 100);\n    }\n    _clearTimeout() {\n        if (this.timer) {\n            clearTimeout(this.timer);\n            this.timer = null;\n        }\n    }\n    getCurrentNode(isOnlyContentChild = false) {\n        const range = this.getRange();\n        let currentNode = range.endContainer;\n        while (currentNode && this.rootElement !== currentNode) {\n            // li元素判断\n            if (!isOnlyContentChild && currentNode.nodeName === 'LI' && currentNode.parentElement?.parentElement === this.rootElement) {\n                return currentNode;\n            }\n            if (currentNode.parentElement === this.rootElement) {\n                return currentNode;\n            }\n            else {\n                currentNode = currentNode.parentNode;\n            }\n        }\n        return this.rootElement.lastElementChild;\n    }\n}\n\nclass EventEmitter {\n    eventList;\n    constructor() {\n        this.eventList = {};\n    }\n    /**\n     * on\n     * @param eventName\n     * @param fn\n     */\n    on(eventName, fn) {\n        if (!eventName || !fn || typeof fn !== 'function')\n            return;\n        if (!this.eventList[eventName]) {\n            this.eventList[eventName] = [];\n        }\n        this.eventList[eventName].push(fn);\n    }\n    /**\n     * emit\n     * @param eventName\n     * @param args\n     */\n    emit(eventName, ...args) {\n        const fnList = this.eventList[eventName];\n        if (!fnList)\n            return;\n        for (let i = 0; i < fnList.length; i++) {\n            try {\n                fnList[i].apply(null, args);\n            }\n            catch (e) {\n                this.emit('error', e, 'emit');\n            }\n        }\n    }\n    /**\n     * off\n     * @param eventName\n     * @param fn\n     */\n    off(eventName, fn) {\n        if (!this.eventList[eventName])\n            return;\n        const eventList = this.eventList[eventName];\n        if (typeof fn === 'function') {\n            const index = eventList.findIndex(item => item === fn);\n            if (index >= 0)\n                eventList.splice(index, 1);\n        }\n        else {\n            this.eventList[eventName].length = 0;\n        }\n        this._removeEmpty(eventName);\n    }\n    /**\n     * remove empty event list\n     * @param eventName\n     * @private\n     */\n    _removeEmpty(eventName) {\n        if (!this.eventList[eventName].length) {\n            delete this.eventList[eventName];\n        }\n    }\n    destroyEventEmitter() {\n        Object.keys(this.eventList).forEach((key => this.off(key)));\n    }\n}\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/05 10:29:43 (GMT+0900)\n */\nclass ZxEditor extends EventEmitter {\n    // 编辑器外部容器HTML元素\n    $wrapper;\n    // 版本\n    version;\n    // 参数\n    options;\n    // 编辑器HTML元素\n    $editor;\n    // 编辑器内容区域HTML元素\n    $content;\n    // 光标处理对象\n    cursor;\n    // 内容元素事件处理函数\n    _contentEvent;\n    // 内容中允许使用的元素标签\n    allowedNodeNames;\n    constructor(selector, options) {\n        super();\n        if (!(this instanceof ZxEditor)) {\n            throw new Error('ZxEditor is a constructor and should be called with the `new` keyword');\n        }\n        /**\n         * ***************************************************\n         * check selector\n         * ***************************************************\n         */\n        const container = $(selector);\n        if (!container) {\n            throw new Error(`Can't found '${selector}' Node in document!`);\n        }\n        this.$wrapper = container;\n        // version\n        this.version = '3.1.0';\n        // options\n        this.options = { ...DEF_OPTIONS, ...options };\n        this.allowedNodeNames = (this.options.allowedNodeNames || ALLOWED_NODE_NAMES).map(item => item.toUpperCase());\n        // elements\n        this.$content = initContentDom(this.options);\n        this.$editor = initEditorDom();\n        this.$editor.append(this.$content);\n        this.$wrapper.append(this.$editor);\n        // cursor\n        this.cursor = new CursorClass(this.$content);\n        // content event handler\n        this._contentEvent = (e) => {\n            const type = e.type;\n            if (type === 'blur')\n                this._lastLine();\n            this.emit(type === 'input' ? 'change' : type, e);\n            checkIsEmpty(this.$content);\n        };\n        this._initEvents();\n    }\n    /**\n     * init events\n     * @private\n     */\n    _initEvents() {\n        this.$content.addEventListener('focus', this._contentEvent);\n        this.$content.addEventListener('blur', this._contentEvent);\n        this.$content.addEventListener('input', this._contentEvent);\n    }\n    /**\n     * 扩展插件\n     * @param plugin\n     */\n    use(plugin) {\n        if (typeof plugin.install === 'function') {\n            plugin.install(this);\n        }\n    }\n    /**\n     * plugin\n     * @param fn\n     */\n    plugin(fn) {\n        if (typeof fn === 'function')\n            fn.call(this);\n    }\n    /**\n     * 设置编辑器内容，会覆盖之前内容\n     * set html to the content element\n     * @param html\n     */\n    setHtml(html) {\n        this.$content.innerHTML = '';\n        this.insert(html);\n        this._lastLine();\n    }\n    /**\n     * 获取编辑器中的HTML代码，会自动去除结尾处的空行\n     * get html string from content element\n     * remove last line that `<section><br></section>`\n     * @return html string\n     */\n    getHtml() {\n        return this.$content.innerHTML.replace(/<section><br><\\/section>$/, '');\n    }\n    /**\n     * 向编辑器中插入内容/HTML代码/元素等\n     * insert html or element to content element\n     * @param input\n     */\n    insert(input) {\n        // insert HTMLElement\n        if (input instanceof HTMLElement) {\n            this._insert(input);\n        }\n        // insert string\n        else {\n            const el = createElement('div');\n            el.innerHTML = input;\n            slice(el.childNodes).forEach((node) => {\n                // element node\n                if (node.nodeType === Node.ELEMENT_NODE) {\n                    // <br> element\n                    if (node.nodeName === NODE_NAME_BR) {\n                        this._insert(createElement(NODE_NAME_SECTION, {}, '<br/>'));\n                    }\n                    else {\n                        this._insert(node);\n                    }\n                }\n                // text\n                else if (node.textContent) {\n                    this._insert(createElement(NODE_NAME_SECTION, {}, node.textContent));\n                }\n            });\n        }\n    }\n    /**\n     * insert element to content element\n     * @param input\n     * @private\n     */\n    _insert(input) {\n        const currentSection = this.cursor.getCurrentNode();\n        if (currentSection) {\n            if (isBrSection(currentSection)) {\n                this.$content.insertBefore(input, currentSection);\n            }\n            else {\n                this.$content.insertBefore(input, currentSection.nextElementSibling);\n            }\n        }\n        else {\n            this.$content.append(input);\n        }\n        if (!this.allowedNodeNames.includes(input.nodeName)) {\n            input = changeNodeName(input, NODE_NAME_SECTION);\n        }\n        this.$content.dispatchEvent(new InputEvent('input'));\n        // 设置光标元素对象\n        this.cursor.setRange(input);\n    }\n    /**\n     * 检查编辑器最后一段是否为空行，非空行则插入\n     * append br section to content element when the lastElementChild is not a br section element\n     * @private\n     */\n    _lastLine() {\n        if (!isBrSection(this.$content.lastElementChild)) {\n            this.$content.appendChild(createElement('section', {}, '<br>'));\n        }\n    }\n    /**\n     * 修改光标所在元素的标签\n     * @param nodeName\n     */\n    changeNodeName(nodeName) {\n        // 判断nodeName是否被允许设置\n        if (!this.allowedNodeNames.includes(nodeName.toUpperCase()))\n            return false;\n        const currentSection = this.cursor.getCurrentNode();\n        return !!(currentSection && changeNodeName(currentSection, nodeName));\n    }\n    /**\n     * 修改光标所在元素的样式\n     * @param styles\n     * @param value\n     */\n    changeStyles(styles, value) {\n        const current = this.cursor.getCurrentNode(true);\n        if (current) {\n            const s = typeof styles === 'string' ? { [styles]: value } : styles;\n            current.setAttribute('style', createStyles(getStyles(current), s));\n        }\n    }\n    /**\n     * 销毁事件\n     * destroy events\n     */\n    destroy() {\n        this.$content.removeEventListener('focus', this._contentEvent);\n        this.$content.removeEventListener('blur', this._contentEvent);\n        this.$content.removeEventListener('input', this._contentEvent);\n        this.destroyEventEmitter();\n    }\n}\n\nexport { ZxEditor };\n//# sourceMappingURL=zx-editor.esm.js.map\n"],"names":["toSnakeCase","str","connectSymbol","replace","s","toLowerCase","toCamelCase","_","toUpperCase","slice","arrLike","offset","Array","prototype","call","$","selector","doc","document","HTMLElement","querySelector","createElement","tag","attrs","innerHTML","el","Object","entries","key","val","setAttribute","createStyles","data","extendStyles","value","arr","push","join","replaceHtmlTag","input","oldNodeName","newNodeName","RegExp","match","isUlElement","test","nodeName","isBrSection","nodes","childNodes","length","getStyles","style","getAttribute","split","reduce","prev","CLASS_NAME_EDITOR","CLASS_NAME_CONTENT","ALLOWED_NODE_NAMES","REPLACE_NODE_LIST","DEF_OPTIONS","editable","minHeight","placeholder","placeholderColor","lineHeight","allowedNodeNames","caretColor","textColor","cursorOffsetTop","customPasteHandler","undefined","toolbarBeenFixed","toolbarHeight","toolbarButtons","imageMaxWidth","imageMaxSize","imageSectionTemp","ignoreGif","forceImageResize","textStyleTitle","textStyleHeadLeftBtnText","textStyleHeadAlign","mainColor","borderColor","NODE_NAME_SECTION","NODE_NAME_BR","initEditorDom","createPseudoClassBefore","beforeStyle","type","append","initContentDom","options","contentStyles","position","overflowY","outline","styles","color","contentAttrs","contenteditable","changeNodeName","tagName","parent","parentElement","newEl","outerHTML","firstChild","childElementCount","firstElementChild","insertBefore","lastElementChild","parentNext","nextElementSibling","elList","children","prevEl","tempEl","shift","removeChild","includes","previousElementSibling","next","nextEls","replaceChild","cloneNode","checkIsEmpty","classList","add","remove","CursorClass","rootElement","timer","setRange","textContent","window","getSelection","getRangeAt","e","Range","node","lastChild","range","getRange","selection","removeAllRanges","targetNode","_getLastNode","setStart","collapse","_clearTimeout","setTimeout","addRange","clearTimeout","isOnlyContentChild","currentNode","endContainer","parentNode","EventEmitter","eventList","eventName","fn","fnList","args","i","apply","emit","index","findIndex","item","splice","_removeEmpty","keys","forEach","off","ZxEditor","Error","container","$wrapper","version","map","$content","$editor","cursor","_contentEvent","_lastLine","_initEvents","addEventListener","plugin","install","html","insert","_insert","nodeType","Node","ELEMENT_NODE","currentSection","getCurrentNode","dispatchEvent","InputEvent","appendChild","current","removeEventListener","destroyEventEmitter"],"mappings":"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"}