{"version":3,"file":"zx-editor.js","sources":["zx-editor.esm.js"],"sourcesContent":["/*!\n * zx-editor v3.1.0\n * https://github.com/capricorncd/zx-editor\n * Released under the MIT License\n * Released on: Sun May 08 2022 21:21:44 GMT+0900 (Japan Standard Time)\n * Copyright © 2018-present, capricorncd\n */\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/05 14:47:02 (GMT+0900)\n */\n/**\n * to snake case\n * helloWorld => hello-world\n * helloWorld => hello_world\n * helloWorld => hello world\n * @param str\n * @param connectSymbol word connect symbol\n */\nconst toSnakeCase = (str, connectSymbol = '-') => {\n    return str.replace(/[A-Z]/g, (s) => `${connectSymbol}${s.toLowerCase()}`);\n};\n/**\n * to camel case\n * hello_world => helloWorld\n * hello-world => helloWorld\n * hello world => helloWorld\n * @param str\n */\n// export const toCamelCase = (str: string): string => {\n//   return str.replace(/[-_\\s](\\w)/g, (_, s) => s.toUpperCase())\n// }\nconst slice = (arrLike, offset = 0) => {\n    return Array.prototype.slice.call(arrLike, offset);\n};\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/05 11:55:07 (GMT+0900)\n */\nconst CLASS_NAME_EDITOR = 'zx-editor';\nconst CLASS_NAME_CONTENT = 'zx-editor-content-wrapper';\n\nconst ALLOWED_NODE_NAMES = ['SECTION', 'H1', 'H2', 'H3', 'H4', 'H5', 'BLOCKQUOTE', 'UL', 'OL'];\nconst DEF_OPTIONS = {\n    // 内容是否可以被编辑\n    editable: true,\n    // 编辑器输入内容绝对定位\n    // fixed: false,\n    // editor min height\n    minHeight: '50vh',\n    // style\n    placeholder: 'Enter...',\n    placeholderColor: '',\n    lineHeight: 1.5,\n    allowedNodeNames: ALLOWED_NODE_NAMES,\n    // paragraph tail spacing, default 10px\n    // paragraphTailSpacing: '',\n    caretColor: '',\n    textColor: '',\n    // iphone会自动移动，难控制\n    // 光标所在行距页面顶部的距离30px\n    cursorOffsetTop: 30,\n    // 自定义粘贴处理函数\n    customPasteHandler: undefined,\n    /**\n     * ******************************\n     * toolbar options\n     * ******************************\n     */\n    // Has the toolbar been fixed?\n    toolbarBeenFixed: true,\n    toolbarHeight: 50,\n    // buttons name, and order\n    toolbarButtons: ['select-picture', 'text-style'],\n    /**\n     * ******************************\n     * image options\n     * ******************************\n     */\n    // customize Picture Handler\n    // customPictureHandler: undefined,\n    // image max width\n    imageMaxWidth: 720,\n    // image max size, unit Kib, default 20M\n    imageMaxSize: 20480,\n    // template\n    imageSectionTemp: `<section class=\"child-is-picture\"><img src=\"{url}\" loading=\"lazy\"></section>`,\n    // GIF pictures are not processed\n    ignoreGif: true,\n    // Force the width/height of the picture, even if the width/height of the picture\n    // is smaller than the target width/height\n    forceImageResize: false,\n    /**\n     * ******************************\n     * text style options\n     * ******************************\n     */\n    // text style, value ['#333', '#f00', ...]\n    // textStyleColors: undefined,\n    textStyleTitle: 'Set Style',\n    textStyleHeadLeftBtnText: 'Clear style',\n    textStyleHeadAlign: 'center',\n    /**\n     * ******************************\n     * color options\n     * ******************************\n     */\n    mainColor: '',\n    // border color\n    borderColor: '',\n};\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/05 10:32:12 (GMT+0900)\n */\nconst NODE_NAME_SECTION = 'SECTION';\nconst NODE_NAME_BR = 'BR';\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/05 10:55:25 (GMT+0900)\n */\nconst REPLACE_NODE_LIST = [\n    'DIV',\n    'P',\n    'ARTICLE',\n    'ASIDE',\n    'DETAILS',\n    'SUMMARY',\n    'FOOTER',\n    'HEADER',\n    'MAIN',\n    'NAV',\n    'SECTION',\n    'H1',\n    'H2',\n    'H3',\n    'H4',\n    'H5',\n    'H6',\n    'BLOCKQUOTE',\n];\nconst $ = (selector, doc = document) => {\n    if (selector instanceof HTMLElement)\n        return selector;\n    return doc.querySelector(selector);\n};\n// export const $$ = <T extends HTMLElement>(selector: string, doc: Document | HTMLElement = document): T[] => {\n//   return Array.prototype.slice.call(doc.querySelectorAll(selector), 0)\n// }\nconst createElement = (tag, attrs = {}, innerHTML) => {\n    const el = document.createElement(tag);\n    for (const [key, val] of Object.entries(attrs)) {\n        el.setAttribute(key, val);\n    }\n    if (innerHTML)\n        el.innerHTML = innerHTML;\n    return el;\n};\nconst createStyles = (data) => {\n    const arr = [];\n    for (const [key, value] of Object.entries(data)) {\n        arr.push(`${toSnakeCase(key)}:${value}`);\n    }\n    return arr.join(';');\n};\nconst replace = (input, oldNodeName, newNodeName) => {\n    return input.replace(RegExp(\"(^<\" + oldNodeName + \")|(\" + oldNodeName + \">$)\", \"gi\"), (match) => match.toUpperCase().replace(oldNodeName, newNodeName.toLowerCase()));\n};\nconst isUlElement = (el) => {\n    return /UL|OL/.test(el.nodeName);\n};\n/**\n *\n * @param input\n * @param tagName\n */\nconst changeNodeName = (input, tagName = NODE_NAME_SECTION) => {\n    const oldNodeName = input.nodeName;\n    const newNodeName = tagName.toUpperCase();\n    if (oldNodeName === newNodeName)\n        return input;\n    const el = createElement(tagName);\n    const parent = input.parentElement;\n    let newEl;\n    // LI元素处理：被修改的元素为UL/OL的内部元素\n    if (oldNodeName === 'LI' && isUlElement(parent)) {\n        // 替换当前LI元素标签为新元素标签\n        el.innerHTML = replace(input.outerHTML, oldNodeName, newNodeName);\n        // 获取新元素\n        newEl = el.firstChild;\n        // 有多个LI元素\n        if (parent.childElementCount > 1) {\n            // 当前LI元素为UL的第一个元素\n            if (parent.firstElementChild === input) {\n                // 将新元素移动至UL/OL前面\n                parent.parentElement?.insertBefore(newEl, parent);\n            }\n            // 当前LI元素为UL的最后一个元素\n            else if (parent.lastElementChild === input) {\n                const parentNext = parent.parentElement?.nextElementSibling;\n                // 下一个兄弟元素存在，添加至下一个兄弟元素前面\n                if (parentNext) {\n                    parentNext.parentElement?.insertBefore(newEl, parentNext);\n                }\n                else {\n                    // 下一个兄弟元素不存在，添加至内容尾部\n                    parent.parentElement?.append(newEl);\n                }\n            }\n            // 当前LI元素为UL中间的一个元素，拆分当前UL/OL\n            else {\n                const elList = slice(parent.children);\n                const prevEl = createElement(parent.nodeName);\n                let tempEl = elList.shift();\n                while (tempEl) {\n                    if (tempEl === input)\n                        break;\n                    prevEl.append(tempEl);\n                    tempEl = elList.shift();\n                }\n                parent.parentElement?.insertBefore(prevEl, parent);\n                // 将新元素插入到当前UL/OL元素前面\n                parent.parentElement?.insertBefore(newEl, parent);\n                // 删除被替换的对象元素\n                parent.removeChild(input);\n            }\n        }\n        // 只有一个LI元素\n        else {\n            // 将新元素移动至UL/OL前面\n            parent.parentElement?.insertBefore(newEl, parent);\n            // 移除UL/OL空元素\n            parent.parentElement?.removeChild(parent);\n        }\n        return newEl;\n    }\n    if (REPLACE_NODE_LIST.includes(oldNodeName)) {\n        // change to ul, ol\n        if (/UL|OL/.test(newNodeName)) {\n            const prev = input.previousElementSibling;\n            const next = input.nextElementSibling;\n            if (prev && isUlElement(prev)) {\n                el.innerHTML = replace(input.outerHTML, oldNodeName, 'li');\n                newEl = el.firstChild;\n                prev.append(newEl);\n                parent?.removeChild(input);\n                // parent的下一个元素也为UL/OL元素，将其合并\n                if (next && next.nodeName === prev.nodeName) {\n                    const nextEls = slice(next.children);\n                    prev.append(...nextEls);\n                    next.parentElement?.removeChild(next);\n                }\n            }\n            else if (next && isUlElement(next)) {\n                el.innerHTML = replace(input.outerHTML, oldNodeName, 'li');\n                newEl = el.firstChild;\n                next.insertBefore(newEl, next.firstElementChild);\n                parent?.removeChild(input);\n                // parent的上一个元素也为UL/OL元素，将其合并\n                // 不可能发生never\n            }\n            else {\n                // 替换当前元素为UL/OL\n                newEl = el;\n                el.innerHTML = replace(input.outerHTML, oldNodeName, 'li');\n                parent?.replaceChild(newEl, input);\n            }\n        }\n        else {\n            el.innerHTML = replace(input.outerHTML, oldNodeName, newNodeName);\n            newEl = el.firstChild;\n            parent?.replaceChild(newEl, input);\n        }\n        return newEl;\n    }\n    el.append(input.cloneNode(true));\n    parent?.replaceChild(el, input);\n    return el;\n};\n/**\n * is <br> section\n * <section><br></section>\n * @param el\n */\nconst isBrSection = (el) => {\n    if (!el)\n        return false;\n    const nodes = slice(el.childNodes);\n    return nodes.length === 1 && nodes[0].nodeName === 'BR';\n};\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/07 10:33:02 (GMT+0900)\n */\nclass CursorClass {\n    rootElement;\n    timer;\n    constructor(rootElement) {\n        this.rootElement = rootElement;\n        this.timer = null;\n        // init range\n        const el = rootElement.lastElementChild;\n        if (el)\n            this.setRange(el, el.textContent?.length);\n    }\n    getRange() {\n        try {\n            // @ts-ignore\n            return window.getSelection()?.getRangeAt(0);\n        }\n        catch (e) {\n            // ..\n        }\n        return new Range();\n    }\n    /**\n     * 获取当前元素的最后一个无子节点的节点\n     * @param el\n     * @private\n     */\n    _getLastNode(el) {\n        let node = el;\n        while (node.lastChild) {\n            node = node.lastChild;\n        }\n        return node;\n    }\n    setRange(el, offset) {\n        const range = this.getRange();\n        // remove all range object\n        const selection = window.getSelection();\n        if (selection)\n            selection.removeAllRanges();\n        // el: '<section>inner text.</section>'\n        // let targetNode = el.childNodes[el.childNodes.length - 1] || el\n        // // check img/video/audio\n        // if (/IMG|VIDEO|AUDIO/.test(targetNode.nodeName)) {\n        //   offset = 1\n        //   // get parentNode, can't set offset = 1 of IMG node.\n        //   targetNode = targetNode.parentNode as HTMLElement\n        // }\n        const targetNode = this._getLastNode(el);\n        if (typeof offset === 'undefined') {\n            offset = targetNode.textContent?.length ?? 0;\n        }\n        range.setStart(targetNode, offset);\n        // cursor start and end position is collapse\n        range.collapse(true);\n        this._clearTimeout();\n        // 延时执行，键盘自动收起后再触发focus\n        // @ts-ignore\n        this.timer = setTimeout(() => {\n            // 插入新的光标对象\n            selection?.addRange(range);\n        }, 100);\n    }\n    _clearTimeout() {\n        if (this.timer) {\n            clearTimeout(this.timer);\n            this.timer = null;\n        }\n    }\n    getCurrentNode() {\n        const range = this.getRange();\n        let currentNode = range.endContainer;\n        while (currentNode && this.rootElement !== currentNode) {\n            // li元素判断\n            if (currentNode.nodeName === 'LI' && currentNode.parentElement?.parentElement === this.rootElement) {\n                return currentNode;\n            }\n            if (currentNode.parentElement === this.rootElement) {\n                return currentNode;\n            }\n            else {\n                currentNode = currentNode.parentNode;\n            }\n        }\n        return this.rootElement.lastElementChild;\n    }\n}\n\nclass EventEmitter {\n    eventList;\n    constructor() {\n        this.eventList = {};\n    }\n    /**\n     * on\n     * @param eventName\n     * @param fn\n     */\n    on(eventName, fn) {\n        if (!eventName || !fn || typeof fn !== 'function')\n            return;\n        if (!this.eventList[eventName]) {\n            this.eventList[eventName] = [];\n        }\n        this.eventList[eventName].push(fn);\n    }\n    /**\n     * emit\n     * @param eventName\n     * @param args\n     */\n    emit(eventName, ...args) {\n        const fnList = this.eventList[eventName];\n        if (!fnList)\n            return;\n        for (let i = 0; i < fnList.length; i++) {\n            try {\n                fnList[i].apply(null, args);\n            }\n            catch (e) {\n                this.emit('error', e, 'emit');\n            }\n        }\n    }\n    /**\n     * off\n     * @param eventName\n     * @param fn\n     */\n    off(eventName, fn) {\n        if (!this.eventList[eventName])\n            return;\n        const eventList = this.eventList[eventName];\n        if (typeof fn === 'function') {\n            const index = eventList.findIndex(item => item === fn);\n            if (index >= 0)\n                eventList.splice(index, 1);\n        }\n        else {\n            this.eventList[eventName].length = 0;\n        }\n        this._removeEmpty(eventName);\n    }\n    /**\n     * remove empty event list\n     * @param eventName\n     * @private\n     */\n    _removeEmpty(eventName) {\n        if (!this.eventList[eventName].length) {\n            delete this.eventList[eventName];\n        }\n    }\n    destroyEventEmitter() {\n        Object.keys(this.eventList).forEach((key => this.off(key)));\n    }\n}\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/05 11:07:32 (GMT+0900)\n */\n/**\n * init editor dom\n */\nconst initEditorDom = () => {\n    const el = createElement('div', {\n        class: CLASS_NAME_EDITOR,\n    });\n    return el;\n};\n/**\n * init content dom\n * @param options\n */\nconst initContentDom = (options) => {\n    const contentStyles = {\n        lineHeight: options.lineHeight,\n        minHeight: options.minHeight,\n        position: 'relative',\n        overflowY: 'scroll',\n        outline: 'none',\n        // 用户自定义样式优先\n        ...options.styles,\n    };\n    if (options.caretColor)\n        contentStyles.caretColor = options.caretColor;\n    if (options.textColor)\n        contentStyles.color = options.textColor;\n    const contentAttrs = {\n        class: `${CLASS_NAME_CONTENT} is-empty`,\n        style: createStyles(contentStyles),\n    };\n    if (options.editable)\n        contentAttrs.contenteditable = 'true';\n    const el = createElement('div', contentAttrs);\n    el.innerHTML = `<section><br></section>`;\n    // return\n    return el;\n};\n\n/**\n * Created by Capricorncd.\n * https://github.com/capricorncd\n * Date: 2022/05/05 10:29:43 (GMT+0900)\n */\nclass ZxEditor extends EventEmitter {\n    $wrapper;\n    version;\n    options;\n    $editor;\n    $content;\n    cursor;\n    _contentEvent;\n    allowedNodeNames;\n    constructor(selector, options) {\n        super();\n        if (!(this instanceof ZxEditor)) {\n            throw new Error('ZxEditor is a constructor and should be called with the `new` keyword');\n        }\n        /**\n         * ***************************************************\n         * check selector\n         * ***************************************************\n         */\n        const container = $(selector);\n        if (!container) {\n            throw new Error(`Can't found '${selector}' Node in document!`);\n        }\n        this.$wrapper = container;\n        // version\n        this.version = '3.1.0';\n        // options\n        this.options = { ...DEF_OPTIONS, ...options };\n        this.allowedNodeNames = (this.options.allowedNodeNames || ALLOWED_NODE_NAMES).map(item => item.toUpperCase());\n        // elements\n        this.$content = initContentDom(this.options);\n        this.$editor = initEditorDom();\n        this.$editor.append(this.$content);\n        this.$wrapper.append(this.$editor);\n        // cursor\n        this.cursor = new CursorClass(this.$content);\n        // content event handler\n        this._contentEvent = (e) => {\n            const type = e.type;\n            if (type === 'blur')\n                this._lastLine();\n            this.emit(type === 'input' ? 'change' : type, e);\n        };\n        this._initEvents();\n    }\n    /**\n     * init events\n     * @private\n     */\n    _initEvents() {\n        this.$content.addEventListener('focus', this._contentEvent);\n        this.$content.addEventListener('blur', this._contentEvent);\n        this.$content.addEventListener('input', this._contentEvent);\n    }\n    /**\n     * use\n     * @param plugin\n     */\n    use(plugin) {\n        if (typeof plugin.install === 'function') {\n            plugin.install(this);\n        }\n    }\n    /**\n     * plugin\n     * @param fn\n     */\n    plugin(fn) {\n        if (typeof fn === 'function')\n            fn.call(this);\n    }\n    /**\n     * set html to the content element\n     * @param html\n     */\n    setHtml(html) {\n        this.$content.innerHTML = '';\n        this.insert(html);\n        this._lastLine();\n    }\n    /**\n     * get html string from content element\n     * remove last line that `<section><br></section>`\n     * @return html string\n     */\n    getHtml() {\n        return this.$content.innerHTML.replace(/<section><br><\\/section>$/, '');\n    }\n    /**\n     * insert html or element to content element\n     * @param input\n     */\n    insert(input) {\n        // insert HTMLElement\n        if (input instanceof HTMLElement) {\n            this._insert(input);\n        }\n        // insert string\n        else {\n            const el = createElement('div');\n            el.innerHTML = input;\n            slice(el.childNodes).forEach((node) => {\n                // element node\n                if (node.nodeType === Node.ELEMENT_NODE) {\n                    // <br> element\n                    if (node.nodeName === NODE_NAME_BR) {\n                        this._insert(createElement(NODE_NAME_SECTION, {}, '<br/>'));\n                    }\n                    else {\n                        this._insert(node);\n                    }\n                }\n                // text\n                else if (node.textContent) {\n                    this._insert(createElement(NODE_NAME_SECTION, {}, node.textContent));\n                }\n            });\n        }\n    }\n    /**\n     * insert element to content element\n     * @param input\n     * @private\n     */\n    _insert(input) {\n        const currentSection = this.cursor.getCurrentNode();\n        console.log(currentSection);\n        if (currentSection) {\n            if (isBrSection(currentSection)) {\n                this.$content.insertBefore(input, currentSection);\n            }\n            else {\n                this.$content.insertBefore(input, currentSection.nextElementSibling);\n            }\n        }\n        else {\n            this.$content.append(input);\n        }\n        if (!this.allowedNodeNames.includes(input.nodeName)) {\n            input = changeNodeName(input, NODE_NAME_SECTION);\n        }\n        this.$content.dispatchEvent(new InputEvent('input'));\n        // 设置光标元素对象\n        this.cursor.setRange(input);\n    }\n    /**\n     * append br section to content element when the lastElementChild is not a br section element\n     * @private\n     */\n    _lastLine() {\n        if (!isBrSection(this.$content.lastElementChild)) {\n            this.$content.appendChild(createElement('section', {}, '<br>'));\n        }\n    }\n    /**\n     * 修改光标所在元素的标签\n     * @param nodeName\n     */\n    changeNodeName(nodeName) {\n        // 判断nodeName是否被允许设置\n        if (!this.allowedNodeNames.includes(nodeName.toUpperCase()))\n            return false;\n        const currentSection = this.cursor.getCurrentNode();\n        return !!(currentSection && changeNodeName(currentSection, nodeName));\n    }\n    /**\n     * destroy events\n     */\n    destroy() {\n        this.$content.removeEventListener('focus', this._contentEvent);\n        this.$content.removeEventListener('blur', this._contentEvent);\n        this.$content.removeEventListener('input', this._contentEvent);\n        this.destroyEventEmitter();\n    }\n}\n\nexport { ZxEditor };\n//# sourceMappingURL=zx-editor.esm.js.map\n"],"names":["toSnakeCase","str","connectSymbol","replace","s","toLowerCase","slice","arrLike","offset","Array","prototype","call","CLASS_NAME_EDITOR","CLASS_NAME_CONTENT","ALLOWED_NODE_NAMES","DEF_OPTIONS","editable","minHeight","placeholder","placeholderColor","lineHeight","allowedNodeNames","caretColor","textColor","cursorOffsetTop","customPasteHandler","undefined","toolbarBeenFixed","toolbarHeight","toolbarButtons","imageMaxWidth","imageMaxSize","imageSectionTemp","ignoreGif","forceImageResize","textStyleTitle","textStyleHeadLeftBtnText","textStyleHeadAlign","mainColor","borderColor","NODE_NAME_SECTION","NODE_NAME_BR","REPLACE_NODE_LIST","$","selector","doc","document","HTMLElement","querySelector","createElement","tag","attrs","innerHTML","el","Object","entries","key","val","setAttribute","createStyles","data","arr","value","push","join","input","oldNodeName","newNodeName","RegExp","match","toUpperCase","isUlElement","test","nodeName","changeNodeName","tagName","parent","parentElement","newEl","outerHTML","firstChild","childElementCount","firstElementChild","insertBefore","lastElementChild","parentNext","nextElementSibling","append","elList","children","prevEl","tempEl","shift","removeChild","includes","prev","previousElementSibling","next","nextEls","replaceChild","cloneNode","isBrSection","nodes","childNodes","length","CursorClass","rootElement","timer","setRange","textContent","window","getSelection","getRangeAt","e","Range","node","lastChild","range","getRange","selection","removeAllRanges","targetNode","_getLastNode","setStart","collapse","_clearTimeout","setTimeout","addRange","clearTimeout","currentNode","endContainer","parentNode","EventEmitter","eventList","eventName","fn","fnList","args","i","apply","emit","index","findIndex","item","splice","_removeEmpty","keys","forEach","off","initEditorDom","initContentDom","options","contentStyles","position","overflowY","outline","styles","color","contentAttrs","style","contenteditable","ZxEditor","Error","container","$wrapper","version","map","$content","$editor","cursor","_contentEvent","type","_lastLine","_initEvents","addEventListener","plugin","install","html","insert","_insert","nodeType","Node","ELEMENT_NODE","currentSection","getCurrentNode","console","log","dispatchEvent","InputEvent","appendChild","removeEventListener","destroyEventEmitter"],"mappings":"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"}