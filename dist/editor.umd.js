/*!
 * @zx-editor/editor version 1.0.0
 * Author: Capricorncd
 * Released under the MIT License
 * Repository: https://github.com/capricorncd/zx-editor
 * Released on: 2022-08-14 23:44:19 (GMT+0900)
 * Copyright © 2018-present, Capricorncd
 */
(function(u,f){typeof exports=="object"&&typeof module<"u"?f(exports):typeof define=="function"&&define.amd?define(["exports"],f):(u=typeof globalThis<"u"?globalThis:u||self,f(u.Editor={}))})(this,function(u){"use strict";var ne=Object.defineProperty;var re=(u,f,N)=>f in u?ne(u,f,{enumerable:!0,configurable:!0,writable:!0,value:N}):u[f]=N;var _=(u,f,N)=>(re(u,typeof f!="symbol"?f+"":f,N),N);class f{constructor(){this._events={}}on(i,e){return!i||!e||typeof e!="function"?this:(this._events[i]||(this._events[i]=[]),this._events[i].push(e),this)}once(i,e){const r=(...s)=>{e.apply(this,s),this.off(i,r)};return this.on(i,r)}emit(i,...e){const r=this._events[i];if(!r)return this;for(let s=0;s<r.length;s++)try{r[s].apply(this,e)}catch(n){this.emit("error",n,"emit")}return this}off(i,e){if(!this._events[i])return this;const r=this._events[i];if(typeof e=="function"){const s=r.findIndex(n=>n===e);s>=0&&r.splice(s,1)}else this._events[i].length=0;return this._removeEmpty(i),this}_removeEmpty(i){this._events[i].length||delete this._events[i]}removeAllListeners(){Object.keys(this._events).forEach(i=>this.off(i))}}/*!
 * zx-sml version 0.5.1
 * Author: Capricorncd <capricorncd@qq.com>
 * Repository: https://github.com/capricorncd/zx-sml
 * Released on: 2022-08-14 09:57:06 (GMT+0900)
 */var N=Object.defineProperty,D=Object.getOwnPropertySymbols,F=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,S=(t,i,e)=>i in t?N(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e,M=(t,i)=>{for(var e in i||(i={}))F.call(i,e)&&S(t,e,i[e]);if(D)for(var e of D(i))W.call(i,e)&&S(t,e,i[e]);return t};function K(t){return Array.isArray(t)}function A(t){return t!==null&&!K(t)&&typeof t=="object"}var V=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},b={exports:{}};/*! For license information please see date-utils-2020.js.LICENSE.txt */(function(t,i){(function(e,r){t.exports=r()})(typeof self<"u"?self:V,function(){return(()=>{var e={949:(s,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.toTwoDigits=void 0,n.toTwoDigits=function(o){return o[1]?o:"0"+o}},607:(s,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.toTwoDigits=n.toDate=n.formatDate=void 0;var a=o(949);Object.defineProperty(n,"toTwoDigits",{enumerable:!0,get:function(){return a.toTwoDigits}});var E={weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};function T(p){if(p instanceof Date)return p;if(typeof p=="number")return new Date(p);if(typeof p=="string"){var l=p.trim();if(/^\d+$/.test(l)){var g=l.length;return g===8?new Date([l.substr(0,4),l.substr(4,2),l.substr(6,2)].join("/")):g===6?new Date([l.substr(0,4),l.substr(4,2),"01"].join("/")):g===4?new Date(l+"/01/01"):new Date(parseInt(p))}if(l=l.replace(/[年月日]/g,function(d){return d==="\u65E5"?"":"/"}).replace(/[(（（].*?[)））]/g," ").replace(/\bam|pm\b/gi," ").replace(/\s+/g," "),/^(\d{4})[-/](\d{1,2})[-/](\d{1,2})$/.test(l))return new Date([RegExp.$1,RegExp.$2,RegExp.$3].join("/"));if(/^(\d{4})[-/](\d{1,2})$/.test(l))return new Date([RegExp.$1,RegExp.$2,"01"].join("/"));var m=new Date(l);return isNaN(m.getFullYear())?null:m}return null}n.formatDate=function(p,l,g){var m,d=T(p);if(!d||!l)return p+"";if(l==="timestamp")return d.getTime().toString();/(y+)/i.test(l)&&(m=RegExp.$1,l=l.replace(m,(d.getFullYear()+"").substr(4-m.length))),g&&Array.isArray(g.weeks)||(g=E);var w={"M+":d.getMonth()+1,"d+":d.getDate(),"h+":d.getHours(),"m+":d.getMinutes(),"s+":d.getSeconds(),"w+":d.getDay(),"W+":g.weeks[d.getDay()],"a+":d.getHours()<12?"am":"pm","A+":d.getHours()<12?"AM":"PM"};for(var c in w)if(new RegExp("("+c+")").test(l)){m=RegExp.$1;var h=w[c]+"";l=l.replace(m,m.length===1?h:a.toTwoDigits(h))}if(/(g)/i.test(l)){var v=d.toString().split(/\s+/).slice(5),te=l.includes("g");l=l.replace(/g/i,te?v[0]:v.join(" "))}return l},n.toDate=T}},r={};return function s(n){if(r[n])return r[n].exports;var o=r[n]={exports:{}};return e[n](o,o.exports,s),o.exports}(607)})()})})(b);function j(t="",i="-"){return t.replace(/[A-Z]/g,(e,r)=>`${r>0?i:""}${e.toLowerCase()}`)}function B(t="",i=!1){const e=t.replace(/[-_\s](\w)/g,(r,s)=>s.toUpperCase());return i?e.replace(/^\w/,r=>r.toUpperCase()):e}function L(t,i=0){return Array.prototype.slice.call(t,i)}function P(t={},i=!1){const e=i?B:j,r={};for(const[s,n]of Object.entries(t))r[e(s)]=A(n)?P(n,i):n;return r}function Y(t,i=document){return t?t instanceof HTMLElement?t:i.querySelector(t):null}function y(t,i={},e){const r=document.createElement(t);for(const[s,n]of Object.entries(i))r.setAttribute(j(s),s==="style"&&A(n)?H(n):n);return e&&(Array.isArray(e)||(e=[e]),e.forEach(s=>{if(typeof s=="string"){const n=y("div");n.innerHTML=s,r.append(...n.childNodes)}else r.append(s)})),r}function H(...t){const i=t.reduce((r,s)=>M(M({},r),P(s)),{}),e=[];for(const[r,s]of Object.entries(i))s===""||typeof s>"u"||s===null||e.push(`${r}:${s}`);return e.join(";")}b.exports.formatDate,b.exports.toDate,b.exports.toTwoDigits;const R=(t,i="style")=>t?(t.getAttribute(i)||"").split(/\s?;\s?/).reduce((r,s)=>{const[n,o]=s.split(/\s?:\s?/);return n&&(r[B(n)]=o),r},{}):{},q=t=>document.createTextNode(t),z="zx-editor__editor",k="SECTION",G="BR",$=[k,"H1","H2","H3","H4","H5","BLOCKQUOTE","UL","OL"];function C(t,i,e){return t.replace(RegExp("(^<"+i+")|("+i+">$)","gi"),r=>r.toUpperCase().replace(i,e.toLowerCase()))}function J(t){return t.replace(/<li[^>]*>(.+)<\/li>/gi,"$1")}function x(t){const i=typeof t=="string"?t:t.nodeName;return/^UL|OL$/i.test(i)}function O(t){if(!t)return!1;const i=L(t.childNodes);return i.length===1&&i[0].nodeName==="BR"}const Q=(t,i)=>{const e={minHeight:t.minHeight,"--placeholder":JSON.stringify(t.placeholder),"--placeholder-color":t.placeholderColor,"--line-height":t.lineHeight,"--paragraph-spacing":t.paragraphTailSpacing,"--padding-bottom":t.paddingBottom,...t.styles};t.caretColor&&(e.caretColor=t.caretColor),t.textColor&&(e.color=t.textColor);const r={class:`${z} is-empty`,style:H(e)};return t.editable&&(r.contenteditable="true"),y("div",r,i)},I=(t,i)=>{var a,E,T,p,l,g,m,d,w;if(!t)return null;const e=t.nodeName,r=i.toUpperCase();if(e===r)return null;const s=y(i),n=t.parentElement;let o;if(e==="LI"&&x(n)){if(s.innerHTML=C(t.outerHTML,e,r),o=s.firstChild,n.childElementCount>1)if(n.firstElementChild===t)(a=n.parentElement)==null||a.insertBefore(o,n);else if(n.lastElementChild===t){const c=(E=n.parentElement)==null?void 0:E.nextElementSibling;c?(T=c.parentElement)==null||T.insertBefore(o,c):(p=n.parentElement)==null||p.append(o)}else{const c=L(n.children),h=y(n.nodeName);let v=c.shift();for(;v&&v!==t;)h.append(v),v=c.shift();(l=n.parentElement)==null||l.insertBefore(h,n),(g=n.parentElement)==null||g.insertBefore(o,n),n.removeChild(t)}else(m=n.parentElement)==null||m.insertBefore(o,n),(d=n.parentElement)==null||d.removeChild(n);return o}if(/UL|OL/.test(r)){const c=t.previousElementSibling,h=t.nextElementSibling;if(c&&x(c)){if(s.innerHTML=C(t.outerHTML,e,"li"),o=s.firstChild,c.append(o),n==null||n.removeChild(t),h&&h.nodeName===c.nodeName){const v=L(h.children);c.append(...v),(w=h.parentElement)==null||w.removeChild(h)}}else h&&x(h)?(s.innerHTML=C(t.outerHTML,e,"li"),o=s.firstChild,h.insertBefore(o,h.firstElementChild),n==null||n.removeChild(t)):(o=s,s.innerHTML=C(t.outerHTML,e,"li"),n==null||n.replaceChild(o,t))}else s.innerHTML=J(C(t.outerHTML,e,r)),o=s.firstChild,n==null||n.replaceChild(o,t);return o},U=t=>{t.children.length<=1&&O(t.children[0])?t.classList.add("is-empty"):t.classList.remove("is-empty")};function X(t,i,e=!1){var r;for(;t&&i!==t;){if(!e&&t.nodeName==="LI"&&((r=t.parentElement)==null?void 0:r.parentElement)===i||t.parentElement===i)return t;t=t.parentElement}return i.lastElementChild}const Z={editable:!0,minHeight:"50vh",paddingBottom:"50vh",placeholder:"\u8BF7\u5728\u6B64\u8F93\u5165\u5185\u5BB9..",placeholderColor:"#999",lineHeight:1.5,childNodeName:k,allowedNodeNames:$,paragraphTailSpacing:"10px",caretColor:"",textColor:"#333333",customPasteHandler:void 0,insertTextToNewParagraph:!1},ie="";class ee extends f{constructor(e){super();_(this,"version");_(this,"options");_(this,"$editor");_(this,"_cursorElement",null);_(this,"_eventHandler");_(this,"allowedNodeNames");_(this,"blankLine");_(this,"_pasteHandler");const r=typeof e.container=="string"?Y(e.container):e.container;if(!r)throw new Error(`Can't found '${e.container}' Node in document!`);this.version="1.0.0",this.options={...Z,...e},this.allowedNodeNames=(this.options.allowedNodeNames||$).map(n=>n.toUpperCase());const s=this.options.childNodeName.toUpperCase();this.options.childNodeName=s,this.blankLine=`<${s}><br></${s}>`,this.allowedNodeNames.includes(s)||this.allowedNodeNames.push(s),this.$editor=Q(this.options,this.blankLine),r.append(this.$editor),this._eventHandler=n=>{const o=n.type;if(o==="blur"||o==="click"){const a=window.getSelection(),E=a&&a.rangeCount?a.getRangeAt(a.rangeCount-1).endContainer:n.currentTarget;this.setCursorElement(E),this._verifyChild()}this.emit(o==="input"?"change":o,n),U(this.$editor)},this._pasteHandler=n=>{var a;if(typeof this.options.customPasteHandler=="function")return this.options.customPasteHandler(n);n.preventDefault();const o=(a=n.clipboardData)==null?void 0:a.getData("text");this._insertText(o)},this._initEvents()}_initEvents(){this.$editor.addEventListener("focus",this._eventHandler),this.$editor.addEventListener("blur",this._eventHandler),this.$editor.addEventListener("input",this._eventHandler),this.$editor.addEventListener("click",this._eventHandler),this.$editor.addEventListener("paste",this._pasteHandler)}use(e,r){typeof e.install=="function"&&e.install(this,r)}setHtml(e){this.$editor.innerHTML=this.blankLine,this.insert(e,!0),this._verifyChild(),U(this.$editor)}getHtml(e){const r=this.$editor.innerHTML;if(e)return r;const s=this.options.childNodeName;return r.replace(new RegExp(`(<${s}><br\\s?\\/?><\\/${s}>)+$`,"i"),"")}insert(e,r=!1){if(e instanceof HTMLElement)this._insertEl(e);else{const s=y("div",{},e),n=L(s.childNodes);if(!r&&!this.options.insertTextToNewParagraph&&n.every(o=>o.nodeType===Node.TEXT_NODE))return this._insertText(e);n.forEach(o=>{o.nodeType===Node.ELEMENT_NODE?o.nodeName===G?this._insertEl(y(this.options.childNodeName,{},"<br/>")):this._insertEl(o):o.textContent&&this._insertEl(y(this.options.childNodeName,{},o.textContent))})}this._dispatchChange()}_insertEl(e){const r=this.getCursorElement();O(r)?/<(\w+)[^>]*>.*<\/\1>/.test(e.outerHTML)?this.$editor.insertBefore(e,r):(r.innerHTML="",r.append(e)):this.$editor.insertBefore(e,r.nextElementSibling),this.setCursorElement(e)}_insertText(e){if(!e)return;const r=window.getSelection(),s=r==null?void 0:r.rangeCount;if(!s)return this.insert(e,!0);r.deleteFromDocument(),r.getRangeAt(0).insertNode(q(e)),this.setCursorElement(r.getRangeAt(s-1).endContainer),r.collapseToEnd(),this._dispatchChange()}_verifyChild(){const e=this.getCursorElement(!0),r=this.options.childNodeName,s=this.$editor.children;let n,o=!1;for(let a=0;a<s.length;a++){if(n=s[a],this.allowedNodeNames.includes(n.nodeName))continue;o=e===n;const E=I(n,r);o&&E&&this.setCursorElement(E)}if(!O(this.$editor.lastElementChild)){const a=this.options.childNodeName;this.$editor.appendChild(y(a,{},"<br>"))}}changeNodeName(e){if(e=(e||this.options.childNodeName).toUpperCase(),!this.allowedNodeNames.includes(e))return!1;const r=this.getCursorElement(),s=I(r,e);return s?(this.setCursorElement(s),this._dispatchChange(),!0):!1}changeStyles(e,r){const s=this.getCursorElement(!0);if(s){const n=R(s);if(e){const o=typeof e=="string"?{[e]:r}:e;s.setAttribute("style",H(n,o))}else{if(!Object.keys(n).length)return;s.removeAttribute("style")}this._dispatchChange()}}_dispatchChange(){this.$editor.dispatchEvent(new InputEvent("input"))}getStyles(){return R(this.getCursorElement())}setCursorElement(e){if(e instanceof Node)for(;e;){if(e.nodeType===Node.ELEMENT_NODE){this._cursorElement=e;break}e=e.parentElement}else e&&(this._cursorElement=e)}getCursorElement(e=!1){return X(this._cursorElement,this.$editor,e)}destroy(){this.$editor.removeEventListener("focus",this._eventHandler),this.$editor.removeEventListener("blur",this._eventHandler),this.$editor.removeEventListener("input",this._eventHandler),this.$editor.removeEventListener("paste",this._pasteHandler),this.removeAllListeners()}}u.ALLOWED_NODE_NAMES=$,u.Editor=ee,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
