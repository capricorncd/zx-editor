function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}!function(e,t){if("function"==typeof define&&define.amd)define(["exports"],t);else if("undefined"!=typeof exports)t(exports);else{var n={exports:{}};t(n.exports),e.unknown=n.exports}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:void 0,(function(t){function n(e,t){return n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}function r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return i(t)}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){return function(e){if(Array.isArray(e))return e}
/*!
   * zx-editor v3.1.0
   * https://github.com/capricorncd/zx-editor
   * Released under the MIT License
   * Released on: Sun May 08 2022 21:21:44 GMT+0900 (Japan Standard Time)
   * Copyright Â© 2018-present, capricorncd
   */(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],l=!0,a=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);l=!0);}catch(e){a=!0,o=e}finally{try{l||null==n.return||n.return()}finally{if(a)throw o}}return i}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(t,"__esModule",{value:!0}),t.ZxEditor=void 0;var m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return e.replace(/[A-Z]/g,(function(e){return"".concat(t).concat(e.toLowerCase())}))},E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Array.prototype.slice.call(e,t)},b=["SECTION","H1","H2","H3","H4","H5","BLOCKQUOTE","UL","OL"],g={editable:!0,minHeight:"50vh",placeholder:"Enter...",placeholderColor:"",lineHeight:1.5,allowedNodeNames:b,caretColor:"",textColor:"",cursorOffsetTop:30,customPasteHandler:void 0,toolbarBeenFixed:!0,toolbarHeight:50,toolbarButtons:["select-picture","text-style"],imageMaxWidth:720,imageMaxSize:20480,imageSectionTemp:'<section class="child-is-picture"><img src="{url}" loading="lazy"></section>',ignoreGif:!0,forceImageResize:!1,textStyleTitle:"Set Style",textStyleHeadLeftBtnText:"Clear style",textStyleHeadAlign:"center",mainColor:"",borderColor:""},C="SECTION",L=["DIV","P","ARTICLE","ASIDE","DETAILS","SUMMARY","FOOTER","HEADER","MAIN","NAV","SECTION","H1","H2","H3","H4","H5","H6","BLOCKQUOTE"],w=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=document.createElement(e),o=0,i=Object.entries(t);o<i.length;o++){var l=p(i[o],2),a=l[0],u=l[1];r.setAttribute(a,u)}return n&&(r.innerHTML=n),r},O=function(e){for(var t=[],n=0,r=Object.entries(e);n<r.length;n++){var o=p(r[n],2),i=o[0],l=o[1];t.push("".concat(m(i),":").concat(l))}return t.join(";")},T=function(e,t,n){return e.replace(RegExp("(^<"+t+")|("+t+">$)","gi"),(function(e){return e.toUpperCase().replace(t,n.toLowerCase())}))},H=function(e){return/UL|OL/.test(e.nodeName)},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C,n=e.nodeName,r=t.toUpperCase();if(n===r)return e;var o,i=w(t),l=e.parentElement;if("LI"===n&&H(l)){var a,u,c;if(i.innerHTML=T(e.outerHTML,n,r),o=i.firstChild,l.childElementCount>1)if(l.firstElementChild===e)null===(a=l.parentElement)||void 0===a||a.insertBefore(o,l);else if(l.lastElementChild===e){var s,f,d,p=null===(s=l.parentElement)||void 0===s?void 0:s.nextElementSibling;if(p)null===(f=p.parentElement)||void 0===f||f.insertBefore(o,p);else null===(d=l.parentElement)||void 0===d||d.append(o)}else{for(var h,y,m=E(l.children),b=w(l.nodeName),g=m.shift();g&&g!==e;)b.append(g),g=m.shift();null===(h=l.parentElement)||void 0===h||h.insertBefore(b,l),null===(y=l.parentElement)||void 0===y||y.insertBefore(o,l),l.removeChild(e)}else null===(u=l.parentElement)||void 0===u||u.insertBefore(o,l),null===(c=l.parentElement)||void 0===c||c.removeChild(l);return o}if(L.includes(n)){if(/UL|OL/.test(r)){var O=e.previousElementSibling,N=e.nextElementSibling;if(O&&H(O)){if(i.innerHTML=T(e.outerHTML,n,"li"),o=i.firstChild,O.append(o),null==l||l.removeChild(e),N&&N.nodeName===O.nodeName){var S,_=E(N.children);O.append.apply(O,v(_)),null===(S=N.parentElement)||void 0===S||S.removeChild(N)}}else N&&H(N)?(i.innerHTML=T(e.outerHTML,n,"li"),o=i.firstChild,N.insertBefore(o,N.firstElementChild),null==l||l.removeChild(e)):(o=i,i.innerHTML=T(e.outerHTML,n,"li"),null==l||l.replaceChild(o,e))}else i.innerHTML=T(e.outerHTML,n,r),o=i.firstChild,null==l||l.replaceChild(o,e);return o}return i.append(e.cloneNode(!0)),null==l||l.replaceChild(i,e),i},S=function(e){if(!e)return!1;var t=E(e.childNodes);return 1===t.length&&"BR"===t[0].nodeName},_=function(){function e(t){var n;c(this,e),d(this,"rootElement",void 0),d(this,"timer",void 0),this.rootElement=t,this.timer=null;var r=t.lastElementChild;r&&this.setRange(r,null===(n=r.textContent)||void 0===n?void 0:n.length)}return f(e,[{key:"getRange",value:function(){try{var e;return null===(e=window.getSelection())||void 0===e?void 0:e.getRangeAt(0)}catch(e){}return new Range}},{key:"_getLastNode",value:function(e){for(var t=e;t.lastChild;)t=t.lastChild;return t}},{key:"setRange",value:function(e,t){var n=this.getRange(),r=window.getSelection();r&&r.removeAllRanges();var o,i,l=this._getLastNode(e);void 0===t&&(t=null!==(o=null===(i=l.textContent)||void 0===i?void 0:i.length)&&void 0!==o?o:0);n.setStart(l,t),n.collapse(!0),this._clearTimeout(),this.timer=setTimeout((function(){null==r||r.addRange(n)}),100)}},{key:"_clearTimeout",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"getCurrentNode",value:function(){for(var e=this.getRange().endContainer;e&&this.rootElement!==e;){var t;if("LI"===e.nodeName&&(null===(t=e.parentElement)||void 0===t?void 0:t.parentElement)===this.rootElement)return e;if(e.parentElement===this.rootElement)return e;e=e.parentNode}return this.rootElement.lastElementChild}}]),e}(),x=function(){function e(){c(this,e),d(this,"eventList",void 0),this.eventList={}}return f(e,[{key:"on",value:function(e,t){e&&t&&"function"==typeof t&&(this.eventList[e]||(this.eventList[e]=[]),this.eventList[e].push(t))}},{key:"emit",value:function(e){var t=this.eventList[e];if(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];for(var i=0;i<t.length;i++)try{t[i].apply(null,r)}catch(e){this.emit("error",e,"emit")}}}},{key:"off",value:function(e,t){if(this.eventList[e]){var n=this.eventList[e];if("function"==typeof t){var r=n.findIndex((function(e){return e===t}));r>=0&&n.splice(r,1)}else this.eventList[e].length=0;this._removeEmpty(e)}}},{key:"_removeEmpty",value:function(e){this.eventList[e].length||delete this.eventList[e]}},{key:"destroyEventEmitter",value:function(){var e=this;Object.keys(this.eventList).forEach((function(t){return e.off(t)}))}}]),e}(),j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)}(o,e);var t=r(o);function o(e,n){var r;if(c(this,o),d(i(r=t.call(this)),"$wrapper",void 0),d(i(r),"version",void 0),d(i(r),"options",void 0),d(i(r),"$editor",void 0),d(i(r),"$content",void 0),d(i(r),"cursor",void 0),d(i(r),"_contentEvent",void 0),d(i(r),"allowedNodeNames",void 0),!(i(r)instanceof o))throw new Error("ZxEditor is a constructor and should be called with the `new` keyword");var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return e instanceof HTMLElement?e:t.querySelector(e)}(e);if(!l)throw new Error("Can't found '".concat(e,"' Node in document!"));return r.$wrapper=l,r.version="3.1.0",r.options=u(u({},g),n),r.allowedNodeNames=(r.options.allowedNodeNames||b).map((function(e){return e.toUpperCase()})),r.$content=function(e){var t=u({lineHeight:e.lineHeight,minHeight:e.minHeight,position:"relative",overflowY:"scroll",outline:"none"},e.styles);e.caretColor&&(t.caretColor=e.caretColor),e.textColor&&(t.color=e.textColor);var n={class:"".concat("zx-editor-content-wrapper"," is-empty"),style:O(t)};e.editable&&(n.contenteditable="true");var r=w("div",n);return r.innerHTML="<section><br></section>",r}(r.options),r.$editor=w("div",{class:"zx-editor"}),r.$editor.append(r.$content),r.$wrapper.append(r.$editor),r.cursor=new _(r.$content),r._contentEvent=function(e){var t=e.type;"blur"===t&&r._lastLine(),r.emit("input"===t?"change":t,e)},r._initEvents(),r}return f(o,[{key:"_initEvents",value:function(){this.$content.addEventListener("focus",this._contentEvent),this.$content.addEventListener("blur",this._contentEvent),this.$content.addEventListener("input",this._contentEvent)}},{key:"use",value:function(e){"function"==typeof e.install&&e.install(this)}},{key:"plugin",value:function(e){"function"==typeof e&&e.call(this)}},{key:"setHtml",value:function(e){this.$content.innerHTML="",this.insert(e),this._lastLine()}},{key:"getHtml",value:function(){return this.$content.innerHTML.replace(/<section><br><\/section>$/,"")}},{key:"insert",value:function(e){var t=this;if(e instanceof HTMLElement)this._insert(e);else{var n=w("div");n.innerHTML=e,E(n.childNodes).forEach((function(e){e.nodeType===Node.ELEMENT_NODE?"BR"===e.nodeName?t._insert(w(C,{},"<br/>")):t._insert(e):e.textContent&&t._insert(w(C,{},e.textContent))}))}}},{key:"_insert",value:function(e){var t=this.cursor.getCurrentNode();console.log(t),t?S(t)?this.$content.insertBefore(e,t):this.$content.insertBefore(e,t.nextElementSibling):this.$content.append(e),this.allowedNodeNames.includes(e.nodeName)||(e=N(e,C)),this.$content.dispatchEvent(new InputEvent("input")),this.cursor.setRange(e)}},{key:"_lastLine",value:function(){S(this.$content.lastElementChild)||this.$content.appendChild(w("section",{},"<br>"))}},{key:"changeNodeName",value:function(e){if(!this.allowedNodeNames.includes(e.toUpperCase()))return!1;var t=this.cursor.getCurrentNode();return!(!t||!N(t,e))}},{key:"destroy",value:function(){this.$content.removeEventListener("focus",this._contentEvent),this.$content.removeEventListener("blur",this._contentEvent),this.$content.removeEventListener("input",this._contentEvent),this.destroyEventEmitter()}}]),o}(x);t.ZxEditor=j}));
//# sourceMappingURL=zx-editor.min.js.map
