{"version":3,"file":"zx-editor.min.js","sources":["zx-editor.js"],"sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\n(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define([\"exports\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(exports);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod.exports);\n    global.unknown = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.ZxEditor = void 0;\n\n  function _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\n  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n  function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\n  function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\n  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n  function _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\n  function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n  function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\n  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\n  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\n  function _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\n  function _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\n  function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\n  function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\n  function _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\n  function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\n  function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n  function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\n  function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n  /*!\n   * zx-editor v3.1.0\n   * https://github.com/capricorncd/zx-editor\n   * Released under the MIT License\n   * Released on: Sun May 08 2022 21:21:44 GMT+0900 (Japan Standard Time)\n   * Copyright © 2018-present, capricorncd\n   */\n\n  /**\n   * Created by Capricorncd.\n   * https://github.com/capricorncd\n   * Date: 2022/05/05 14:47:02 (GMT+0900)\n   */\n\n  /**\n   * to snake case\n   * helloWorld => hello-world\n   * helloWorld => hello_world\n   * helloWorld => hello world\n   * @param str\n   * @param connectSymbol word connect symbol\n   */\n  var toSnakeCase = function toSnakeCase(str) {\n    var connectSymbol = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return str.replace(/[A-Z]/g, function (s) {\n      return \"\".concat(connectSymbol).concat(s.toLowerCase());\n    });\n  };\n  /**\n   * to camel case\n   * hello_world => helloWorld\n   * hello-world => helloWorld\n   * hello world => helloWorld\n   * @param str\n   */\n  // export const toCamelCase = (str: string): string => {\n  //   return str.replace(/[-_\\s](\\w)/g, (_, s) => s.toUpperCase())\n  // }\n\n\n  var slice = function slice(arrLike) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    return Array.prototype.slice.call(arrLike, offset);\n  };\n  /**\n   * Created by Capricorncd.\n   * https://github.com/capricorncd\n   * Date: 2022/05/05 11:55:07 (GMT+0900)\n   */\n\n\n  var CLASS_NAME_EDITOR = 'zx-editor';\n  var CLASS_NAME_CONTENT = 'zx-editor-content-wrapper';\n  var ALLOWED_NODE_NAMES = ['SECTION', 'H1', 'H2', 'H3', 'H4', 'H5', 'BLOCKQUOTE', 'UL', 'OL'];\n  var DEF_OPTIONS = {\n    // 内容是否可以被编辑\n    editable: true,\n    // 编辑器输入内容绝对定位\n    // fixed: false,\n    // editor min height\n    minHeight: '50vh',\n    // style\n    placeholder: 'Enter...',\n    placeholderColor: '',\n    lineHeight: 1.5,\n    allowedNodeNames: ALLOWED_NODE_NAMES,\n    // paragraph tail spacing, default 10px\n    // paragraphTailSpacing: '',\n    caretColor: '',\n    textColor: '',\n    // iphone会自动移动，难控制\n    // 光标所在行距页面顶部的距离30px\n    cursorOffsetTop: 30,\n    // 自定义粘贴处理函数\n    customPasteHandler: undefined,\n\n    /**\n     * ******************************\n     * toolbar options\n     * ******************************\n     */\n    // Has the toolbar been fixed?\n    toolbarBeenFixed: true,\n    toolbarHeight: 50,\n    // buttons name, and order\n    toolbarButtons: ['select-picture', 'text-style'],\n\n    /**\n     * ******************************\n     * image options\n     * ******************************\n     */\n    // customize Picture Handler\n    // customPictureHandler: undefined,\n    // image max width\n    imageMaxWidth: 720,\n    // image max size, unit Kib, default 20M\n    imageMaxSize: 20480,\n    // template\n    imageSectionTemp: \"<section class=\\\"child-is-picture\\\"><img src=\\\"{url}\\\" loading=\\\"lazy\\\"></section>\",\n    // GIF pictures are not processed\n    ignoreGif: true,\n    // Force the width/height of the picture, even if the width/height of the picture\n    // is smaller than the target width/height\n    forceImageResize: false,\n\n    /**\n     * ******************************\n     * text style options\n     * ******************************\n     */\n    // text style, value ['#333', '#f00', ...]\n    // textStyleColors: undefined,\n    textStyleTitle: 'Set Style',\n    textStyleHeadLeftBtnText: 'Clear style',\n    textStyleHeadAlign: 'center',\n\n    /**\n     * ******************************\n     * color options\n     * ******************************\n     */\n    mainColor: '',\n    // border color\n    borderColor: ''\n  };\n  /**\n   * Created by Capricorncd.\n   * https://github.com/capricorncd\n   * Date: 2022/05/05 10:32:12 (GMT+0900)\n   */\n\n  var NODE_NAME_SECTION = 'SECTION';\n  var NODE_NAME_BR = 'BR';\n  /**\n   * Created by Capricorncd.\n   * https://github.com/capricorncd\n   * Date: 2022/05/05 10:55:25 (GMT+0900)\n   */\n\n  var REPLACE_NODE_LIST = ['DIV', 'P', 'ARTICLE', 'ASIDE', 'DETAILS', 'SUMMARY', 'FOOTER', 'HEADER', 'MAIN', 'NAV', 'SECTION', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'BLOCKQUOTE'];\n\n  var $ = function $(selector) {\n    var doc = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;\n    if (selector instanceof HTMLElement) return selector;\n    return doc.querySelector(selector);\n  }; // export const $$ = <T extends HTMLElement>(selector: string, doc: Document | HTMLElement = document): T[] => {\n  //   return Array.prototype.slice.call(doc.querySelectorAll(selector), 0)\n  // }\n\n\n  var createElement = function createElement(tag) {\n    var attrs = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var innerHTML = arguments.length > 2 ? arguments[2] : undefined;\n    var el = document.createElement(tag);\n\n    for (var _i = 0, _Object$entries = Object.entries(attrs); _i < _Object$entries.length; _i++) {\n      var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n          key = _Object$entries$_i[0],\n          val = _Object$entries$_i[1];\n\n      el.setAttribute(key, val);\n    }\n\n    if (innerHTML) el.innerHTML = innerHTML;\n    return el;\n  };\n\n  var createStyles = function createStyles(data) {\n    var arr = [];\n\n    for (var _i2 = 0, _Object$entries2 = Object.entries(data); _i2 < _Object$entries2.length; _i2++) {\n      var _Object$entries2$_i = _slicedToArray(_Object$entries2[_i2], 2),\n          key = _Object$entries2$_i[0],\n          value = _Object$entries2$_i[1];\n\n      arr.push(\"\".concat(toSnakeCase(key), \":\").concat(value));\n    }\n\n    return arr.join(';');\n  };\n\n  var replace = function replace(input, oldNodeName, newNodeName) {\n    return input.replace(RegExp(\"(^<\" + oldNodeName + \")|(\" + oldNodeName + \">$)\", \"gi\"), function (match) {\n      return match.toUpperCase().replace(oldNodeName, newNodeName.toLowerCase());\n    });\n  };\n\n  var isUlElement = function isUlElement(el) {\n    return /UL|OL/.test(el.nodeName);\n  };\n  /**\n   *\n   * @param input\n   * @param tagName\n   */\n\n\n  var _changeNodeName = function changeNodeName(input) {\n    var tagName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : NODE_NAME_SECTION;\n    var oldNodeName = input.nodeName;\n    var newNodeName = tagName.toUpperCase();\n    if (oldNodeName === newNodeName) return input;\n    var el = createElement(tagName);\n    var parent = input.parentElement;\n    var newEl; // LI元素处理：被修改的元素为UL/OL的内部元素\n\n    if (oldNodeName === 'LI' && isUlElement(parent)) {\n      // 替换当前LI元素标签为新元素标签\n      el.innerHTML = replace(input.outerHTML, oldNodeName, newNodeName); // 获取新元素\n\n      newEl = el.firstChild; // 有多个LI元素\n\n      if (parent.childElementCount > 1) {\n        // 当前LI元素为UL的第一个元素\n        if (parent.firstElementChild === input) {\n          var _parent$parentElement;\n\n          // 将新元素移动至UL/OL前面\n          (_parent$parentElement = parent.parentElement) === null || _parent$parentElement === void 0 ? void 0 : _parent$parentElement.insertBefore(newEl, parent);\n        } // 当前LI元素为UL的最后一个元素\n        else if (parent.lastElementChild === input) {\n          var _parent$parentElement2;\n\n          var parentNext = (_parent$parentElement2 = parent.parentElement) === null || _parent$parentElement2 === void 0 ? void 0 : _parent$parentElement2.nextElementSibling; // 下一个兄弟元素存在，添加至下一个兄弟元素前面\n\n          if (parentNext) {\n            var _parentNext$parentEle;\n\n            (_parentNext$parentEle = parentNext.parentElement) === null || _parentNext$parentEle === void 0 ? void 0 : _parentNext$parentEle.insertBefore(newEl, parentNext);\n          } else {\n            var _parent$parentElement3;\n\n            // 下一个兄弟元素不存在，添加至内容尾部\n            (_parent$parentElement3 = parent.parentElement) === null || _parent$parentElement3 === void 0 ? void 0 : _parent$parentElement3.append(newEl);\n          }\n        } // 当前LI元素为UL中间的一个元素，拆分当前UL/OL\n        else {\n          var _parent$parentElement4, _parent$parentElement5;\n\n          var elList = slice(parent.children);\n          var prevEl = createElement(parent.nodeName);\n          var tempEl = elList.shift();\n\n          while (tempEl) {\n            if (tempEl === input) break;\n            prevEl.append(tempEl);\n            tempEl = elList.shift();\n          }\n\n          (_parent$parentElement4 = parent.parentElement) === null || _parent$parentElement4 === void 0 ? void 0 : _parent$parentElement4.insertBefore(prevEl, parent); // 将新元素插入到当前UL/OL元素前面\n\n          (_parent$parentElement5 = parent.parentElement) === null || _parent$parentElement5 === void 0 ? void 0 : _parent$parentElement5.insertBefore(newEl, parent); // 删除被替换的对象元素\n\n          parent.removeChild(input);\n        }\n      } // 只有一个LI元素\n      else {\n        var _parent$parentElement6, _parent$parentElement7;\n\n        // 将新元素移动至UL/OL前面\n        (_parent$parentElement6 = parent.parentElement) === null || _parent$parentElement6 === void 0 ? void 0 : _parent$parentElement6.insertBefore(newEl, parent); // 移除UL/OL空元素\n\n        (_parent$parentElement7 = parent.parentElement) === null || _parent$parentElement7 === void 0 ? void 0 : _parent$parentElement7.removeChild(parent);\n      }\n\n      return newEl;\n    }\n\n    if (REPLACE_NODE_LIST.includes(oldNodeName)) {\n      // change to ul, ol\n      if (/UL|OL/.test(newNodeName)) {\n        var prev = input.previousElementSibling;\n        var next = input.nextElementSibling;\n\n        if (prev && isUlElement(prev)) {\n          el.innerHTML = replace(input.outerHTML, oldNodeName, 'li');\n          newEl = el.firstChild;\n          prev.append(newEl);\n          parent === null || parent === void 0 ? void 0 : parent.removeChild(input); // parent的下一个元素也为UL/OL元素，将其合并\n\n          if (next && next.nodeName === prev.nodeName) {\n            var _next$parentElement;\n\n            var nextEls = slice(next.children);\n            prev.append.apply(prev, _toConsumableArray(nextEls));\n            (_next$parentElement = next.parentElement) === null || _next$parentElement === void 0 ? void 0 : _next$parentElement.removeChild(next);\n          }\n        } else if (next && isUlElement(next)) {\n          el.innerHTML = replace(input.outerHTML, oldNodeName, 'li');\n          newEl = el.firstChild;\n          next.insertBefore(newEl, next.firstElementChild);\n          parent === null || parent === void 0 ? void 0 : parent.removeChild(input); // parent的上一个元素也为UL/OL元素，将其合并\n          // 不可能发生never\n        } else {\n          // 替换当前元素为UL/OL\n          newEl = el;\n          el.innerHTML = replace(input.outerHTML, oldNodeName, 'li');\n          parent === null || parent === void 0 ? void 0 : parent.replaceChild(newEl, input);\n        }\n      } else {\n        el.innerHTML = replace(input.outerHTML, oldNodeName, newNodeName);\n        newEl = el.firstChild;\n        parent === null || parent === void 0 ? void 0 : parent.replaceChild(newEl, input);\n      }\n\n      return newEl;\n    }\n\n    el.append(input.cloneNode(true));\n    parent === null || parent === void 0 ? void 0 : parent.replaceChild(el, input);\n    return el;\n  };\n  /**\n   * is <br> section\n   * <section><br></section>\n   * @param el\n   */\n\n\n  var isBrSection = function isBrSection(el) {\n    if (!el) return false;\n    var nodes = slice(el.childNodes);\n    return nodes.length === 1 && nodes[0].nodeName === 'BR';\n  };\n  /**\n   * Created by Capricorncd.\n   * https://github.com/capricorncd\n   * Date: 2022/05/07 10:33:02 (GMT+0900)\n   */\n\n\n  var CursorClass = /*#__PURE__*/function () {\n    function CursorClass(rootElement) {\n      var _el$textContent;\n\n      _classCallCheck(this, CursorClass);\n\n      _defineProperty(this, \"rootElement\", void 0);\n\n      _defineProperty(this, \"timer\", void 0);\n\n      this.rootElement = rootElement;\n      this.timer = null; // init range\n\n      var el = rootElement.lastElementChild;\n      if (el) this.setRange(el, (_el$textContent = el.textContent) === null || _el$textContent === void 0 ? void 0 : _el$textContent.length);\n    }\n\n    _createClass(CursorClass, [{\n      key: \"getRange\",\n      value: function getRange() {\n        try {\n          var _window$getSelection;\n\n          // @ts-ignore\n          return (_window$getSelection = window.getSelection()) === null || _window$getSelection === void 0 ? void 0 : _window$getSelection.getRangeAt(0);\n        } catch (e) {// ..\n        }\n\n        return new Range();\n      }\n      /**\n       * 获取当前元素的最后一个无子节点的节点\n       * @param el\n       * @private\n       */\n\n    }, {\n      key: \"_getLastNode\",\n      value: function _getLastNode(el) {\n        var node = el;\n\n        while (node.lastChild) {\n          node = node.lastChild;\n        }\n\n        return node;\n      }\n    }, {\n      key: \"setRange\",\n      value: function setRange(el, offset) {\n        var range = this.getRange(); // remove all range object\n\n        var selection = window.getSelection();\n        if (selection) selection.removeAllRanges(); // el: '<section>inner text.</section>'\n        // let targetNode = el.childNodes[el.childNodes.length - 1] || el\n        // // check img/video/audio\n        // if (/IMG|VIDEO|AUDIO/.test(targetNode.nodeName)) {\n        //   offset = 1\n        //   // get parentNode, can't set offset = 1 of IMG node.\n        //   targetNode = targetNode.parentNode as HTMLElement\n        // }\n\n        var targetNode = this._getLastNode(el);\n\n        if (typeof offset === 'undefined') {\n          var _targetNode$textConte, _targetNode$textConte2;\n\n          offset = (_targetNode$textConte = (_targetNode$textConte2 = targetNode.textContent) === null || _targetNode$textConte2 === void 0 ? void 0 : _targetNode$textConte2.length) !== null && _targetNode$textConte !== void 0 ? _targetNode$textConte : 0;\n        }\n\n        range.setStart(targetNode, offset); // cursor start and end position is collapse\n\n        range.collapse(true);\n\n        this._clearTimeout(); // 延时执行，键盘自动收起后再触发focus\n        // @ts-ignore\n\n\n        this.timer = setTimeout(function () {\n          // 插入新的光标对象\n          selection === null || selection === void 0 ? void 0 : selection.addRange(range);\n        }, 100);\n      }\n    }, {\n      key: \"_clearTimeout\",\n      value: function _clearTimeout() {\n        if (this.timer) {\n          clearTimeout(this.timer);\n          this.timer = null;\n        }\n      }\n    }, {\n      key: \"getCurrentNode\",\n      value: function getCurrentNode() {\n        var range = this.getRange();\n        var currentNode = range.endContainer;\n\n        while (currentNode && this.rootElement !== currentNode) {\n          var _currentNode$parentEl;\n\n          // li元素判断\n          if (currentNode.nodeName === 'LI' && ((_currentNode$parentEl = currentNode.parentElement) === null || _currentNode$parentEl === void 0 ? void 0 : _currentNode$parentEl.parentElement) === this.rootElement) {\n            return currentNode;\n          }\n\n          if (currentNode.parentElement === this.rootElement) {\n            return currentNode;\n          } else {\n            currentNode = currentNode.parentNode;\n          }\n        }\n\n        return this.rootElement.lastElementChild;\n      }\n    }]);\n\n    return CursorClass;\n  }();\n\n  var EventEmitter = /*#__PURE__*/function () {\n    function EventEmitter() {\n      _classCallCheck(this, EventEmitter);\n\n      _defineProperty(this, \"eventList\", void 0);\n\n      this.eventList = {};\n    }\n    /**\n     * on\n     * @param eventName\n     * @param fn\n     */\n\n\n    _createClass(EventEmitter, [{\n      key: \"on\",\n      value: function on(eventName, fn) {\n        if (!eventName || !fn || typeof fn !== 'function') return;\n\n        if (!this.eventList[eventName]) {\n          this.eventList[eventName] = [];\n        }\n\n        this.eventList[eventName].push(fn);\n      }\n      /**\n       * emit\n       * @param eventName\n       * @param args\n       */\n\n    }, {\n      key: \"emit\",\n      value: function emit(eventName) {\n        var fnList = this.eventList[eventName];\n        if (!fnList) return;\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        for (var i = 0; i < fnList.length; i++) {\n          try {\n            fnList[i].apply(null, args);\n          } catch (e) {\n            this.emit('error', e, 'emit');\n          }\n        }\n      }\n      /**\n       * off\n       * @param eventName\n       * @param fn\n       */\n\n    }, {\n      key: \"off\",\n      value: function off(eventName, fn) {\n        if (!this.eventList[eventName]) return;\n        var eventList = this.eventList[eventName];\n\n        if (typeof fn === 'function') {\n          var index = eventList.findIndex(function (item) {\n            return item === fn;\n          });\n          if (index >= 0) eventList.splice(index, 1);\n        } else {\n          this.eventList[eventName].length = 0;\n        }\n\n        this._removeEmpty(eventName);\n      }\n      /**\n       * remove empty event list\n       * @param eventName\n       * @private\n       */\n\n    }, {\n      key: \"_removeEmpty\",\n      value: function _removeEmpty(eventName) {\n        if (!this.eventList[eventName].length) {\n          delete this.eventList[eventName];\n        }\n      }\n    }, {\n      key: \"destroyEventEmitter\",\n      value: function destroyEventEmitter() {\n        var _this = this;\n\n        Object.keys(this.eventList).forEach(function (key) {\n          return _this.off(key);\n        });\n      }\n    }]);\n\n    return EventEmitter;\n  }();\n  /**\n   * Created by Capricorncd.\n   * https://github.com/capricorncd\n   * Date: 2022/05/05 11:07:32 (GMT+0900)\n   */\n\n  /**\n   * init editor dom\n   */\n\n\n  var initEditorDom = function initEditorDom() {\n    var el = createElement('div', {\n      \"class\": CLASS_NAME_EDITOR\n    });\n    return el;\n  };\n  /**\n   * init content dom\n   * @param options\n   */\n\n\n  var initContentDom = function initContentDom(options) {\n    var contentStyles = _objectSpread({\n      lineHeight: options.lineHeight,\n      minHeight: options.minHeight,\n      position: 'relative',\n      overflowY: 'scroll',\n      outline: 'none'\n    }, options.styles);\n\n    if (options.caretColor) contentStyles.caretColor = options.caretColor;\n    if (options.textColor) contentStyles.color = options.textColor;\n    var contentAttrs = {\n      \"class\": \"\".concat(CLASS_NAME_CONTENT, \" is-empty\"),\n      style: createStyles(contentStyles)\n    };\n    if (options.editable) contentAttrs.contenteditable = 'true';\n    var el = createElement('div', contentAttrs);\n    el.innerHTML = \"<section><br></section>\"; // return\n\n    return el;\n  };\n  /**\n   * Created by Capricorncd.\n   * https://github.com/capricorncd\n   * Date: 2022/05/05 10:29:43 (GMT+0900)\n   */\n\n\n  var ZxEditor = /*#__PURE__*/function (_EventEmitter) {\n    _inherits(ZxEditor, _EventEmitter);\n\n    var _super = _createSuper(ZxEditor);\n\n    function ZxEditor(selector, options) {\n      var _this2;\n\n      _classCallCheck(this, ZxEditor);\n\n      _this2 = _super.call(this);\n\n      _defineProperty(_assertThisInitialized(_this2), \"$wrapper\", void 0);\n\n      _defineProperty(_assertThisInitialized(_this2), \"version\", void 0);\n\n      _defineProperty(_assertThisInitialized(_this2), \"options\", void 0);\n\n      _defineProperty(_assertThisInitialized(_this2), \"$editor\", void 0);\n\n      _defineProperty(_assertThisInitialized(_this2), \"$content\", void 0);\n\n      _defineProperty(_assertThisInitialized(_this2), \"cursor\", void 0);\n\n      _defineProperty(_assertThisInitialized(_this2), \"_contentEvent\", void 0);\n\n      _defineProperty(_assertThisInitialized(_this2), \"allowedNodeNames\", void 0);\n\n      if (!(_assertThisInitialized(_this2) instanceof ZxEditor)) {\n        throw new Error('ZxEditor is a constructor and should be called with the `new` keyword');\n      }\n      /**\n       * ***************************************************\n       * check selector\n       * ***************************************************\n       */\n\n\n      var container = $(selector);\n\n      if (!container) {\n        throw new Error(\"Can't found '\".concat(selector, \"' Node in document!\"));\n      }\n\n      _this2.$wrapper = container; // version\n\n      _this2.version = '3.1.0'; // options\n\n      _this2.options = _objectSpread(_objectSpread({}, DEF_OPTIONS), options);\n      _this2.allowedNodeNames = (_this2.options.allowedNodeNames || ALLOWED_NODE_NAMES).map(function (item) {\n        return item.toUpperCase();\n      }); // elements\n\n      _this2.$content = initContentDom(_this2.options);\n      _this2.$editor = initEditorDom();\n\n      _this2.$editor.append(_this2.$content);\n\n      _this2.$wrapper.append(_this2.$editor); // cursor\n\n\n      _this2.cursor = new CursorClass(_this2.$content); // content event handler\n\n      _this2._contentEvent = function (e) {\n        var type = e.type;\n        if (type === 'blur') _this2._lastLine();\n\n        _this2.emit(type === 'input' ? 'change' : type, e);\n      };\n\n      _this2._initEvents();\n\n      return _this2;\n    }\n    /**\n     * init events\n     * @private\n     */\n\n\n    _createClass(ZxEditor, [{\n      key: \"_initEvents\",\n      value: function _initEvents() {\n        this.$content.addEventListener('focus', this._contentEvent);\n        this.$content.addEventListener('blur', this._contentEvent);\n        this.$content.addEventListener('input', this._contentEvent);\n      }\n      /**\n       * use\n       * @param plugin\n       */\n\n    }, {\n      key: \"use\",\n      value: function use(plugin) {\n        if (typeof plugin.install === 'function') {\n          plugin.install(this);\n        }\n      }\n      /**\n       * plugin\n       * @param fn\n       */\n\n    }, {\n      key: \"plugin\",\n      value: function plugin(fn) {\n        if (typeof fn === 'function') fn.call(this);\n      }\n      /**\n       * set html to the content element\n       * @param html\n       */\n\n    }, {\n      key: \"setHtml\",\n      value: function setHtml(html) {\n        this.$content.innerHTML = '';\n        this.insert(html);\n\n        this._lastLine();\n      }\n      /**\n       * get html string from content element\n       * remove last line that `<section><br></section>`\n       * @return html string\n       */\n\n    }, {\n      key: \"getHtml\",\n      value: function getHtml() {\n        return this.$content.innerHTML.replace(/<section><br><\\/section>$/, '');\n      }\n      /**\n       * insert html or element to content element\n       * @param input\n       */\n\n    }, {\n      key: \"insert\",\n      value: function insert(input) {\n        var _this3 = this;\n\n        // insert HTMLElement\n        if (input instanceof HTMLElement) {\n          this._insert(input);\n        } // insert string\n        else {\n          var el = createElement('div');\n          el.innerHTML = input;\n          slice(el.childNodes).forEach(function (node) {\n            // element node\n            if (node.nodeType === Node.ELEMENT_NODE) {\n              // <br> element\n              if (node.nodeName === NODE_NAME_BR) {\n                _this3._insert(createElement(NODE_NAME_SECTION, {}, '<br/>'));\n              } else {\n                _this3._insert(node);\n              }\n            } // text\n            else if (node.textContent) {\n              _this3._insert(createElement(NODE_NAME_SECTION, {}, node.textContent));\n            }\n          });\n        }\n      }\n      /**\n       * insert element to content element\n       * @param input\n       * @private\n       */\n\n    }, {\n      key: \"_insert\",\n      value: function _insert(input) {\n        var currentSection = this.cursor.getCurrentNode();\n        console.log(currentSection);\n\n        if (currentSection) {\n          if (isBrSection(currentSection)) {\n            this.$content.insertBefore(input, currentSection);\n          } else {\n            this.$content.insertBefore(input, currentSection.nextElementSibling);\n          }\n        } else {\n          this.$content.append(input);\n        }\n\n        if (!this.allowedNodeNames.includes(input.nodeName)) {\n          input = _changeNodeName(input, NODE_NAME_SECTION);\n        }\n\n        this.$content.dispatchEvent(new InputEvent('input')); // 设置光标元素对象\n\n        this.cursor.setRange(input);\n      }\n      /**\n       * append br section to content element when the lastElementChild is not a br section element\n       * @private\n       */\n\n    }, {\n      key: \"_lastLine\",\n      value: function _lastLine() {\n        if (!isBrSection(this.$content.lastElementChild)) {\n          this.$content.appendChild(createElement('section', {}, '<br>'));\n        }\n      }\n      /**\n       * 修改光标所在元素的标签\n       * @param nodeName\n       */\n\n    }, {\n      key: \"changeNodeName\",\n      value: function changeNodeName(nodeName) {\n        // 判断nodeName是否被允许设置\n        if (!this.allowedNodeNames.includes(nodeName.toUpperCase())) return false;\n        var currentSection = this.cursor.getCurrentNode();\n        return !!(currentSection && _changeNodeName(currentSection, nodeName));\n      }\n      /**\n       * destroy events\n       */\n\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        this.$content.removeEventListener('focus', this._contentEvent);\n        this.$content.removeEventListener('blur', this._contentEvent);\n        this.$content.removeEventListener('input', this._contentEvent);\n        this.destroyEventEmitter();\n      }\n    }]);\n\n    return ZxEditor;\n  }(EventEmitter);\n\n  _exports.ZxEditor = ZxEditor;\n});\n//# sourceMappingURL=zx-editor.js.map\n"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","global","factory","define","amd","exports","mod","unknown","globalThis","self","this","_exports","_setPrototypeOf","o","p","Object","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","call","e","_isNativeReflectConstruct","result","Super","_getPrototypeOf","NewTarget","arguments","apply","_possibleConstructorReturn","TypeError","_assertThisInitialized","ReferenceError","getPrototypeOf","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","_objectSpread","target","i","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","value","_toConsumableArray","arr","Array","isArray","_arrayLikeToArray","_arrayWithoutHoles","iter","from","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","_slicedToArray","_arrayWithHoles","_i","_s","_e","_arr","_n","_d","next","done","err","_iterableToArrayLimit","_nonIterableRest","minLen","n","toString","slice","name","test","len","arr2","ZxEditor","toSnakeCase","str","connectSymbol","undefined","replace","s","concat","toLowerCase","arrLike","offset","ALLOWED_NODE_NAMES","DEF_OPTIONS","editable","minHeight","placeholder","placeholderColor","lineHeight","allowedNodeNames","caretColor","textColor","cursorOffsetTop","customPasteHandler","toolbarBeenFixed","toolbarHeight","toolbarButtons","imageMaxWidth","imageMaxSize","imageSectionTemp","ignoreGif","forceImageResize","textStyleTitle","textStyleHeadLeftBtnText","textStyleHeadAlign","mainColor","borderColor","NODE_NAME_SECTION","REPLACE_NODE_LIST","createElement","tag","attrs","innerHTML","el","document","_Object$entries","entries","_Object$entries$_i","val","setAttribute","createStyles","data","_i2","_Object$entries2","_Object$entries2$_i","join","input","oldNodeName","newNodeName","RegExp","match","toUpperCase","isUlElement","nodeName","_changeNodeName","tagName","newEl","parent","parentElement","_parent$parentElement","_parent$parentElement6","_parent$parentElement7","outerHTML","firstChild","childElementCount","firstElementChild","insertBefore","lastElementChild","_parent$parentElement2","_parentNext$parentEle","_parent$parentElement3","parentNext","nextElementSibling","append","_parent$parentElement4","_parent$parentElement5","elList","children","prevEl","tempEl","shift","removeChild","includes","prev","previousElementSibling","_next$parentElement","nextEls","replaceChild","cloneNode","isBrSection","nodes","childNodes","CursorClass","rootElement","_el$textContent","timer","setRange","textContent","_window$getSelection","window","getSelection","getRangeAt","Range","node","lastChild","range","getRange","selection","removeAllRanges","_targetNode$textConte","_targetNode$textConte2","targetNode","_getLastNode","setStart","collapse","_clearTimeout","setTimeout","addRange","clearTimeout","currentNode","endContainer","_currentNode$parentEl","parentNode","EventEmitter","eventList","eventName","fn","fnList","_len","args","_key","emit","index","findIndex","item","splice","_removeEmpty","_this","off","_EventEmitter","subClass","superClass","create","_inherits","_super","selector","options","_this2","Error","container","doc","HTMLElement","querySelector","$","$wrapper","version","map","$content","contentStyles","position","overflowY","outline","styles","color","contentAttrs","class","style","contenteditable","initContentDom","$editor","cursor","_contentEvent","type","_lastLine","_initEvents","addEventListener","plugin","install","html","insert","_this3","_insert","nodeType","Node","ELEMENT_NODE","currentSection","getCurrentNode","console","log","dispatchEvent","InputEvent","appendChild","removeEventListener","destroyEventEmitter"],"mappings":"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"}