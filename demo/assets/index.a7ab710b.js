var ue=Object.defineProperty;var fe=(t,e,r)=>e in t?ue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var g=(t,e,r)=>(fe(t,typeof e!="symbol"?e+"":e,r),r);const ge=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}};ge();class pe{constructor(){this._events={}}on(e,r){return!e||!r||typeof r!="function"?this:(this._events[e]||(this._events[e]=[]),this._events[e].push(r),this)}once(e,r){const i=(...n)=>{r.apply(this,n),this.off(e,i)};return this.on(e,i)}emit(e,...r){const i=this._events[e];if(!i)return this;for(let n=0;n<i.length;n++)try{i[n].apply(this,r)}catch(s){this.emit("error",s,"emit")}return this}off(e,r){if(!this._events[e])return this;const i=this._events[e];if(typeof r=="function"){const n=i.findIndex(s=>s===r);n>=0&&i.splice(n,1)}else this._events[e].length=0;return this._removeEmpty(e),this}_removeEmpty(e){this._events[e].length||delete this._events[e]}removeAllListeners(){Object.keys(this._events).forEach(e=>this.off(e))}}function ye(){return window.screen.height===812&&window.screen.width===375}/*!
 * zx-sml version 0.2.1
 * Author: Capricorncd <capricorncd@qq.com>
 * Repository: https://github.com/capricorncd/zx-sml
 * Released on: 2022-07-24 15:34:05 (GMT+0900)
 */var we=Object.defineProperty,j=Object.getOwnPropertySymbols,me=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable,B=(t,e,r)=>e in t?we(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,F=(t,e)=>{for(var r in e||(e={}))me.call(e,r)&&B(t,r,e[r]);if(j)for(var r of j(e))_e.call(e,r)&&B(t,r,e[r]);return t};function Ee(t){return Array.isArray(t)}function K(t){return t!==null&&!Ee(t)&&typeof t=="object"}var be=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},L={exports:{}};/*! For license information please see date-utils-2020.js.LICENSE.txt */(function(t,e){(function(r,i){t.exports=i()})(typeof self<"u"?self:be,function(){return(()=>{var r={949:(n,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.toTwoDigits=void 0,s.toTwoDigits=function(o){return o[1]?o:"0"+o}},607:(n,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.toTwoDigits=s.toDate=s.formatDate=void 0;var c=o(949);Object.defineProperty(s,"toTwoDigits",{enumerable:!0,get:function(){return c.toTwoDigits}});var u={weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};function f(l){if(l instanceof Date)return l;if(typeof l=="number")return new Date(l);if(typeof l=="string"){var a=l.trim();if(/^\d+$/.test(a)){var h=a.length;return h===8?new Date([a.substr(0,4),a.substr(4,2),a.substr(6,2)].join("/")):h===6?new Date([a.substr(0,4),a.substr(4,2),"01"].join("/")):h===4?new Date(a+"/01/01"):new Date(parseInt(l))}if(a=a.replace(/[年月日]/g,function(d){return d==="\u65E5"?"":"/"}).replace(/[(（（].*?[)））]/g," ").replace(/\bam|pm\b/gi," ").replace(/\s+/g," "),/^(\d{4})[-/](\d{1,2})[-/](\d{1,2})$/.test(a))return new Date([RegExp.$1,RegExp.$2,RegExp.$3].join("/"));if(/^(\d{4})[-/](\d{1,2})$/.test(a))return new Date([RegExp.$1,RegExp.$2,"01"].join("/"));var p=new Date(a);return isNaN(p.getFullYear())?null:p}return null}s.formatDate=function(l,a,h){var p,d=f(l);if(!d||!a)return l+"";if(a==="timestamp")return d.getTime().toString();/(y+)/i.test(a)&&(p=RegExp.$1,a=a.replace(p,(d.getFullYear()+"").substr(4-p.length))),h&&Array.isArray(h.weeks)||(h=u);var E={"M+":d.getMonth()+1,"d+":d.getDate(),"h+":d.getHours(),"m+":d.getMinutes(),"s+":d.getSeconds(),"w+":d.getDay(),"W+":h.weeks[d.getDay()],"a+":d.getHours()<12?"am":"pm","A+":d.getHours()<12?"AM":"PM"};for(var y in E)if(new RegExp("("+y+")").test(a)){p=RegExp.$1;var w=E[y]+"";a=a.replace(p,p.length===1?w:c.toTwoDigits(w))}if(/(g)/i.test(a)){var _=d.toString().split(/\s+/).slice(5),S=a.includes("g");a=a.replace(/g/i,S?_[0]:_.join(" "))}return a},s.toDate=f}},i={};return function n(s){if(i[s])return i[s].exports;var o=i[s]={exports:{}};return r[s](o,o.exports,n),o.exports}(607)})()})})(L);function V(t="",e="-"){return t.replace(/[A-Z]/g,(r,i)=>`${i>0?e:""}${r.toLowerCase()}`)}function Z(t="",e=!1){const r=t.replace(/[-_\s](\w)/g,(i,n)=>n.toUpperCase());return e?r.replace(/^\w/,i=>i.toUpperCase()):r}function X(t){return typeof t=="string"?t:t===null||typeof t>"u"?"":Array.isArray(t)?t.map(X).join(" "):typeof t=="object"?Object.keys(t).filter(e=>t[e]).join(" "):String(t)}function ve(...t){return t.map(X).filter(e=>!!e).join(" ")}function v(t,e=0){return Array.prototype.slice.call(t,e)}function Q(t={},e=!1){const r=e?Z:V,i={};for(const[n,s]of Object.entries(t))i[r(n)]=K(s)?Q(s,e):s;return i}function x(t,e=document){return t?t instanceof HTMLElement?t:e.querySelector(t):null}function C(t,e=document){return v(e.querySelectorAll(t))}function m(t,e={},r){const i=document.createElement(t);for(const[n,s]of Object.entries(e))i.setAttribute(V(n),n==="style"&&K(s)?R(s):s);return r&&(Array.isArray(r)||(r=[r]),r.forEach(n=>{if(typeof n=="string"){const s=m("div");s.innerHTML=n,i.append(...s.childNodes)}else i.append(n)})),i}function R(...t){const e=t.reduce((i,n)=>F(F({},i),Q(n)),{}),r=[];for(const[i,n]of Object.entries(e))n===""||typeof n>"u"||n===null||r.push(`${i}:${n}`);return r.join(";")}L.exports.formatDate;L.exports.toDate;L.exports.toTwoDigits;const N=(t,e="style")=>t?(t.getAttribute(e)||"").split(/\s?;\s?/).reduce((i,n)=>{const[s,o]=n.split(/\s?:\s?/);return s&&(i[Z(s)]=o),i},{}):{},A=t=>document.createTextNode(t),J=t=>{if(!t)return null;if(typeof t=="string")return A(t);const{tag:e,attrs:r,child:i}=t;if(!e&&!r&&!i)return null;const n=m(e||"div",r);if(Array.isArray(i)&&i.length){let s;i.forEach(o=>{s=J(o),s&&n.appendChild(s)})}else i&&typeof i=="string"&&n.appendChild(A(i));return n},xe=(t,e)=>{t.classList.add(e)},$e=(t,e)=>{t.classList.remove(e)},Ce="zx-editor__editor",T="SECTION",Te="BR",ee=["SECTION","H1","H2","H3","H4","H5","BLOCKQUOTE","UL","OL"],Le=["DIV","P","ARTICLE","ASIDE","DETAILS","SUMMARY","FOOTER","HEADER","MAIN","NAV","SECTION","H1","H2","H3","H4","H5","H6","BLOCKQUOTE"],te="<section><br></section>";function $(t,e,r){return t.replace(RegExp("(^<"+e+")|("+e+">$)","gi"),i=>i.toUpperCase().replace(e,r.toLowerCase()))}function D(t){return/^UL|OL$/.test(t.nodeName)}function I(t){if(!t)return!1;const e=v(t.childNodes);return e.length===1&&e[0].nodeName==="BR"}const He=t=>{const e={minHeight:t.minHeight,"--placeholder":JSON.stringify(t.placeholder),"--placeholder-color":t.placeholderColor,"--line-height":t.lineHeight,"--paragraph-spacing":t.paragraphTailSpacing,...t.styles};t.caretColor&&(e.caretColor=t.caretColor),t.textColor&&(e.color=t.textColor);const r={class:`${Ce} is-empty`,style:R(e)};return t.editable&&(r.contenteditable="true"),m("div",r,te)},k=(t,e=T)=>{var c,u,f,l,a,h,p,d,E;if(!t)return null;const r=t.nodeName,i=e.toUpperCase();if(r===i)return t;const n=m(e),s=t.parentElement;let o;if(r==="LI"&&D(s)){if(n.innerHTML=$(t.outerHTML,r,i),o=n.firstChild,s.childElementCount>1)if(s.firstElementChild===t)(c=s.parentElement)==null||c.insertBefore(o,s);else if(s.lastElementChild===t){const y=(u=s.parentElement)==null?void 0:u.nextElementSibling;y?(f=y.parentElement)==null||f.insertBefore(o,y):(l=s.parentElement)==null||l.append(o)}else{const y=v(s.children),w=m(s.nodeName);let _=y.shift();for(;_&&_!==t;)w.append(_),_=y.shift();(a=s.parentElement)==null||a.insertBefore(w,s),(h=s.parentElement)==null||h.insertBefore(o,s),s.removeChild(t)}else(p=s.parentElement)==null||p.insertBefore(o,s),(d=s.parentElement)==null||d.removeChild(s);return o}if(Le.includes(r)){if(/UL|OL/.test(i)){const y=t.previousElementSibling,w=t.nextElementSibling;if(y&&D(y)){if(n.innerHTML=$(t.outerHTML,r,"li"),o=n.firstChild,y.append(o),s==null||s.removeChild(t),w&&w.nodeName===y.nodeName){const _=v(w.children);y.append(..._),(E=w.parentElement)==null||E.removeChild(w)}}else w&&D(w)?(n.innerHTML=$(t.outerHTML,r,"li"),o=n.firstChild,w.insertBefore(o,w.firstElementChild),s==null||s.removeChild(t)):(o=n,n.innerHTML=$(t.outerHTML,r,"li"),s==null||s.replaceChild(o,t))}else n.innerHTML=$(t.outerHTML,r,i),o=n.firstChild,s==null||s.replaceChild(o,t);return o}return n.append(t.cloneNode(!0)),s==null||s.replaceChild(n,t),n},U=t=>{t.children.length<=1&&I(t.children[0])?t.classList.add("is-empty"):t.classList.remove("is-empty")};function Se(t,e,r=!1){var i;for(;t&&e!==t;){if(!r&&t.nodeName==="LI"&&((i=t.parentElement)==null?void 0:i.parentElement)===e||t.parentElement===e)return t;t=t.parentElement}return e.lastElementChild}const De={editable:!0,minHeight:"50vh",placeholder:"\u8BF7\u5728\u6B64\u8F93\u5165\u5185\u5BB9..",placeholderColor:"#999",lineHeight:1.5,allowedNodeNames:ee,paragraphTailSpacing:"10px",caretColor:"",textColor:"",customPasteHandler:void 0,insertTextToNewParagraph:!1};class Oe extends pe{constructor(r){super();g(this,"version");g(this,"options");g(this,"$editor");g(this,"_cursorElement",null);g(this,"_eventHandler");g(this,"allowedNodeNames");g(this,"_pasteHandler");const i=typeof r.container=="string"?x(r.container):r.container;if(!i)throw new Error(`Can't found '${r.container}' Node in document!`);this.version="__VERSION__",this.options={...De,...r},this.allowedNodeNames=(this.options.allowedNodeNames||ee).map(n=>n.toUpperCase()),this.$editor=He(this.options),i.append(this.$editor),this._eventHandler=n=>{var o;const s=n.type;s==="blur"&&(this._lastLine(),this.setCursorElement((o=window.getSelection())==null?void 0:o.getRangeAt(0).endContainer)),this.emit(s==="input"?"change":s,n),U(this.$editor)},this._pasteHandler=n=>{var c;if(typeof this.options.customPasteHandler=="function")return this.options.customPasteHandler(n);n.stopPropagation();const s=(c=n.clipboardData)==null?void 0:c.getData("text"),o=window.getSelection();this._insertText(s,o)},this._initEvents()}_initEvents(){this.$editor.addEventListener("focus",this._eventHandler),this.$editor.addEventListener("blur",this._eventHandler),this.$editor.addEventListener("input",this._eventHandler),this.$editor.addEventListener("click",this._eventHandler),this.$editor.addEventListener("paste",this._pasteHandler)}use(r,i){typeof r.install=="function"&&r.install(this,i)}setHtml(r){this.$editor.innerHTML=te,this.insert(r,!0),this._lastLine(),U(this.$editor)}getHtml(){return this.$editor.innerHTML.replace(/<section><br><\/section>$/,"")}insert(r,i=!1){if(r instanceof HTMLElement)this._insert(r);else{const n=m("div",{},r),s=v(n.childNodes);if(!i&&!this.options.insertTextToNewParagraph&&s.every(o=>o.nodeType===Node.TEXT_NODE))return this._insertText(r);s.forEach(o=>{o.nodeType===Node.ELEMENT_NODE?o.nodeName===Te?this._insert(m(T,{},"<br/>")):this._insert(o):o.textContent&&this._insert(m(T,{},o.textContent))})}this._dispatchChange()}_insert(r){const i=this.getCursorElement();I(i)?this.$editor.insertBefore(r,i):this.$editor.insertBefore(r,i.nextElementSibling),this.allowedNodeNames.includes(r.nodeName)||(r=k(r,T)),this.setCursorElement(r)}_insertText(r,i){if(!!r){if(i=i!=null?i:window.getSelection(),!(i!=null&&i.rangeCount))return this.insert(r,!0);i.deleteFromDocument(),i.getRangeAt(0).insertNode(A(r)),this.setCursorElement(i.getRangeAt(0).endContainer),this._dispatchChange()}}_lastLine(){I(this.$editor.lastElementChild)||this.$editor.appendChild(m("section",{},"<br>"))}changeNodeName(r){if(!this.allowedNodeNames.includes(r.toUpperCase()))return!1;const i=this.getCursorElement(),n=k(i,r);return console.log(n),n?(this.setCursorElement(n),this._dispatchChange(),!0):!1}changeStyles(r,i){const n=this.getCursorElement(!0);if(n){const s=typeof r=="string"?{[r]:i}:r;n.setAttribute("style",R(N(n),s)),this._dispatchChange()}}_dispatchChange(){this.$editor.dispatchEvent(new InputEvent("input"))}getStyles(){return N(this.getCursorElement())}setCursorElement(r){if(r instanceof Node)for(;r;){if(r.nodeType===Node.ELEMENT_NODE){this._cursorElement=r;break}r=r.parentElement}else r&&(this._cursorElement=r)}getCursorElement(r=!1){return Se(this._cursorElement,this.$editor,r)}destroy(){this.$editor.removeEventListener("focus",this._eventHandler),this.$editor.removeEventListener("blur",this._eventHandler),this.$editor.removeEventListener("input",this._eventHandler),this.$editor.removeEventListener("paste",this._pasteHandler),this.removeAllListeners()}}const Ne={textStyleTitle:"Set Style",textStyleHeadLeftBtnText:"Clear style"},Ae=["#333","#d0d0d0","#ff583d","#fdaa25","#44c67b","#14b2e0","#b065e2"],Ie={tag:"dl",attrs:{class:"__style-wrapper border-bottom"},child:[{tag:"dd",attrs:{style:"font-weight: 800;","data-style":"fontWeight:800"},child:["B"]},{tag:"dd",attrs:{style:"font-style: italic;","data-style":"fontStyle:italic"},child:["I"]},{tag:"dd",attrs:{style:"text-decoration: line-through;","data-style":"textDecoration:line-through"},child:["abc"]},{tag:"dd",attrs:{style:"","data-style":"textAlign:left",class:"text-align--l"}},{tag:"dd",attrs:{style:"","data-style":"textAlign:center",class:"text-align--c"}},{tag:"dd",attrs:{style:"","data-style":"textAlign:right",class:"text-align--r"}}]},Pe={tag:"dl",attrs:{class:"__tag-wrapper"},child:[{tag:"dd",attrs:{class:"__h2","data-tag":"h2"},child:["\u5927\u6807\u9898",{tag:"i"}]},{tag:"dd",attrs:{class:"__h4","data-tag":"h4"},child:["\u5C0F\u6807\u9898",{tag:"i"}]},{tag:"dd",attrs:{class:"__section active","data-tag":"section"},child:["\u6B63\u6587",{tag:"i"}]},{tag:"dd",attrs:{class:"__blockquote","data-tag":"blockquote"},child:["\u5F15\u7528",{tag:"i"}]},{tag:"dd",attrs:{class:"__ul","data-tag":"ul"},child:["\u65E0\u5E8F\u5217\u8868",{tag:"i"}]}]},Re=t=>{const e=[];return t.forEach((r,i)=>{/^#\w{3,6}$/.test(r)&&e.push({tag:"dd",attrs:{class:i===0?"active":"","data-color":Me(r.toLowerCase())},child:[{tag:"i",attrs:{style:`background:${r}`}}]})}),e},Me=t=>t.length===7?t:`#${t[1]}${t[1]}${t[2]}${t[2]}${t[3]}${t[3]}`;const b="zx-editor-style-panel",O=`${b}__fade-in`;class je{constructor(e){g(this,"editorInstance",null);g(this,"$el");g(this,"_headerSwitchHandler");g(this,"$elMap");g(this,"_styleHandler");g(this,"_colorHandler");g(this,"_tagHandler");const r={...Ne,...e};this.$el=m("div",{class:`${b} border-top`});const i=m("div",{class:`${b}__header`},r.textStyleTitle),n=m("div",{class:`${b}__header__left`},r.textStyleHeadLeftBtnText),s=m("div",{class:`${b}__header__switch`});i.append(n,s);const o=[Ie],c=Array.isArray(r.textStyleColors)?r.textStyleColors:Ae;if(c.length){const f={tag:"dl",attrs:{class:"__color-wrapper border-bottom"},child:Re(c)};o.push(f)}o.push(Pe);const u=J({tag:"div",attrs:{class:`${b}__body`},child:o});this.$el.append(i,u),this.$elMap=new Map([["headerSwitch",s]]),this._headerSwitchHandler=()=>{this.$el.classList.contains(O)?this.hide():this.show()},this._styleHandler=f=>{const l=this.editorInstance,a=f.currentTarget,h=N(a,"data-style"),p=l.getStyles();Object.keys(h).forEach(d=>{p[d]&&(h[d]="")}),l.changeStyles(h)},this._colorHandler=f=>{const l=f.currentTarget;if(l.classList.contains("active"))return;x(".active",l.parentElement).classList.remove("active"),l.classList.add("active");const a=this.editorInstance,h=l.getAttribute("data-color");a.changeStyles({color:h})},this._tagHandler=f=>{const l=f.currentTarget;if(l.classList.contains("active"))return;x(".active",l.parentElement).classList.remove("active"),l.classList.add("active");const a=this.editorInstance,h=l.getAttribute("data-tag");a.changeNodeName(h)},s.addEventListener("click",this._headerSwitchHandler),C(".__style-wrapper dd",u).forEach(f=>{f.addEventListener("click",this._styleHandler)}),C(".__color-wrapper dd",u).forEach(f=>{f.addEventListener("click",this._colorHandler)}),C(".__tag-wrapper dd",u).forEach(f=>{f.addEventListener("click",this._tagHandler)})}install(e,r){this.editorInstance=e,r&&r.append(this.$el)}show(){this.$el.classList.add(O)}hide(){this.$el.classList.remove(O)}destroy(){var e;(e=this.$elMap.get("headerSwitch"))==null||e.removeEventListener("click",this._headerSwitchHandler)}}const Be={toolbarBeenFixed:!0,toolbarHeight:50,toolbarButtons:["choose-picture","text-style"]},Fe=34;class ke{constructor(e){g(this,"editorInstance",null);g(this,"visible");g(this,"options");g(this,"$el");g(this,"_btnClickHandler");this.options={...Be,...e},this.visible=this.options.toolbarBeenFixed;const r=this.options.toolbarHeight;this.$el=m("div",{class:"zx-editor__toolbar border-top",style:{"--bar-height":r+"px",height:`${r+(ye()?Fe:0)}px`}},'<dl class="inner-wrapper"></dl>'),this._btnClickHandler=i=>{const n=i.currentTarget;this.editorInstance&&n&&this.editorInstance.emit("toolbarButtonClick",n.getAttribute("data-name"))},this.options.toolbarButtons.forEach(i=>{this.addButton({name:i})})}install(e,r){this.editorInstance=e,r&&r.append(this.$el),this.visible&&this.show()}show(){xe(this.$el,"__fade-in"),this.visible=!0,this.editorInstance.emit("toolbarShow",!0,this)}hide(){$e(this.$el,"__fade-in"),this.visible=!1,this.editorInstance.emit("toolbarShow",!1,this)}addButton(e,r){const i={...e.style},n=m("dd",{class:ve("icon-item",e.className),dataName:e.name,style:i},e.innerHtml),s=C("dd",this.$el),o=x("dl",this.$el);typeof r=="number"&&r<s.length?o.insertBefore(n,s[r]):o.append(n),n.addEventListener("click",this._btnClickHandler)}destroy(){C(".icon-item",this.$el).forEach(e=>{e.removeEventListener("click",this._btnClickHandler)})}}/*!
 * image-process version 4.2.1
 * Author: Capricorncd <capricorncd@qq.com>
 * Repository: https://github.com/capricorncd/image-process-tools
 * Released on: 2022-07-23 16:12:35 (GMT+0900)
 *//*!
 * zx-sml version 0.2.0
 * Author: Capricorncd <capricorncd@qq.com>
 * Repository: https://github.com/capricorncd/zx-sml
 * Released on: 2022-07-13 22:46:38 (GMT+0900)
 */var Ue=Object.defineProperty,z=Object.getOwnPropertySymbols,ze=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable,W=(t,e,r)=>e in t?Ue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,G=(t,e)=>{for(var r in e||(e={}))ze.call(e,r)&&W(t,r,e[r]);if(z)for(var r of z(e))We.call(e,r)&&W(t,r,e[r]);return t};function Ge(t){return Array.isArray(t)}function re(t){return t!==null&&!Ge(t)&&typeof t=="object"}var Ye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},H={exports:{}};/*! For license information please see date-utils-2020.js.LICENSE.txt */(function(t,e){(function(r,i){t.exports=i()})(typeof self<"u"?self:Ye,function(){return(()=>{var r={949:(n,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.toTwoDigits=void 0,s.toTwoDigits=function(o){return o[1]?o:"0"+o}},607:(n,s,o)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.toTwoDigits=s.toDate=s.formatDate=void 0;var c=o(949);Object.defineProperty(s,"toTwoDigits",{enumerable:!0,get:function(){return c.toTwoDigits}});var u={weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};function f(l){if(l instanceof Date)return l;if(typeof l=="number")return new Date(l);if(typeof l=="string"){var a=l.trim();if(/^\d+$/.test(a)){var h=a.length;return h===8?new Date([a.substr(0,4),a.substr(4,2),a.substr(6,2)].join("/")):h===6?new Date([a.substr(0,4),a.substr(4,2),"01"].join("/")):h===4?new Date(a+"/01/01"):new Date(parseInt(l))}if(a=a.replace(/[年月日]/g,function(d){return d==="\u65E5"?"":"/"}).replace(/[(（（].*?[)））]/g," ").replace(/\bam|pm\b/gi," ").replace(/\s+/g," "),/^(\d{4})[-/](\d{1,2})[-/](\d{1,2})$/.test(a))return new Date([RegExp.$1,RegExp.$2,RegExp.$3].join("/"));if(/^(\d{4})[-/](\d{1,2})$/.test(a))return new Date([RegExp.$1,RegExp.$2,"01"].join("/"));var p=new Date(a);return isNaN(p.getFullYear())?null:p}return null}s.formatDate=function(l,a,h){var p,d=f(l);if(!d||!a)return l+"";if(a==="timestamp")return d.getTime().toString();/(y+)/i.test(a)&&(p=RegExp.$1,a=a.replace(p,(d.getFullYear()+"").substr(4-p.length))),h&&Array.isArray(h.weeks)||(h=u);var E={"M+":d.getMonth()+1,"d+":d.getDate(),"h+":d.getHours(),"m+":d.getMinutes(),"s+":d.getSeconds(),"w+":d.getDay(),"W+":h.weeks[d.getDay()],"a+":d.getHours()<12?"am":"pm","A+":d.getHours()<12?"AM":"PM"};for(var y in E)if(new RegExp("("+y+")").test(a)){p=RegExp.$1;var w=E[y]+"";a=a.replace(p,p.length===1?w:c.toTwoDigits(w))}if(/(g)/i.test(a)){var _=d.toString().split(/\s+/).slice(5),S=a.includes("g");a=a.replace(/g/i,S?_[0]:_.join(" "))}return a},s.toDate=f}},i={};return function n(s){if(i[s])return i[s].exports;var o=i[s]={exports:{}};return r[s](o,o.exports,n),o.exports}(607)})()})})(H);function ie(t="",e="-"){return t.replace(/[A-Z]/g,(r,i)=>`${i>0?e:""}${r.toLowerCase()}`)}function qe(t="",e=!1){const r=t.replace(/[-_\s](\w)/g,(i,n)=>n.toUpperCase());return e?r.replace(/^\w/,i=>i.toUpperCase()):r}function ne(t={},e=!1){const r=e?qe:ie,i={};for(const[n,s]of Object.entries(t))i[r(n)]=re(s)?ne(s,e):s;return i}function se(t,e=!1,r=2){const i=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],n=e?1e3:1024;let s=String(t),o="Byte";for(let c=0,u=t/n;u>1;u/=n,c++)s=u.toFixed(r),o=i[c];return e&&(o=o.replace("i","")),{text:s.replace(/\.0+$/,"")+o,value:+s,unit:o,bytes:t}}function Ke(t,e={},r){const i=document.createElement(t);for(const[n,s]of Object.entries(e))i.setAttribute(ie(n),n==="style"&&re(s)?Ve(s):s);return r&&(typeof r=="string"?i.innerHTML=r:i.append(r)),i}function Ve(...t){const e=t.reduce((i,n)=>G(G({},i),ne(n)),{}),r=[];for(const[i,n]of Object.entries(e))n===""||typeof n>"u"||n===null||r.push(`${i}:${n}`);return r.join(";")}function Ze(t){return new Promise((e,r)=>{const i=new FileReader;i.onload=n=>{var s;const o=(s=n.target)==null?void 0:s.result;o?e(o):r(new Error(`FileReader's result is null, ${n.target}`))},i.onerror=r,i.readAsDataURL(t)})}function oe(t){return(window.URL||window.webkitURL).createObjectURL(t)}function ae(t){const e=t.split(",");let r="";return/data:(\w+\/\w+);base64/.test(e[0])&&(r=RegExp.$1),{type:r,data:e[1]}}function le(t,e){const r=ae(t),i=window.atob(r.data);e=e||r.type;const n=new Uint8Array(i.length);for(let s=0;s<i.length;s++)n[s]=i.charCodeAt(s);return new Blob([n],{type:e})}H.exports.formatDate;H.exports.toDate;H.exports.toTwoDigits;const Xe={enableDevicePixelRatio:!1,isForce:!1,mimeType:"image/jpeg",perResize:500,quality:.9,width:0,height:0,longestSide:0},Qe=/^data:(.+?);base64/,Je=/^image\/.+/;function et(t,e){return new Promise((r,i)=>{const n={...Xe,...e};typeof t=="string"&&Qe.test(t)?Y(t,n,r,i):(t instanceof File||t instanceof Blob)&&Je.test(t.type)?Ze(t).then(s=>{Y(s,n,r,i)}).catch(i):i(new Error(`Invalid file, ${t}`))})}function Y(t,e,r,i){const{type:n}=ae(t),s=le(t,n),o=new Image;o.onload=()=>{const c={element:o,blob:s,data:t,url:oe(s),width:o.naturalWidth||o.width,height:o.naturalHeight||o.height,type:n,size:se(s.size)};e.cropInfo&&e.cropInfo.sw&&e.cropInfo.sh?q(c,e,r,i,{...e.cropInfo,dx:0,dy:0,dw:e.cropInfo.sw,dh:e.cropInfo.sh}):e.width>0&&e.height>0?q(c,e,r,i,rt(c,e)):e.width>0||e.height>0||e.longestSide>0?tt(c,e,r,i):P({...c,raw:c},e,r)},o.onerror=i,o.src=t}function q(t,e,r,i,n){try{Object.prototype.hasOwnProperty.call(n,"enableDevicePixelRatio")||(n.enableDevicePixelRatio=e.enableDevicePixelRatio);const s=M(t.element,{enableDevicePixelRatio:e.enableDevicePixelRatio,sx:n.sx,sy:n.sy,sw:n.sw,sh:n.sh,dx:0,dy:0,dw:n.sw,dh:n.sh});!e.width&&!e.height?e.longestSide?n.sw>n.sh?(e.width=e.longestSide,e.height=n.sh*e.width/n.sw):(e.height=e.longestSide,e.width=n.sw*e.height/n.sh):(e.width=n.sw,e.height=n.sh):e.width?e.height=n.sh*e.width/n.sw:e.width=n.sw*e.height/n.sh,ce(s,t,e,{...n,sx:0,sy:0,sw:s.width,sh:s.height},r)}catch(s){i(s)}}function tt(t,e,r,i){try{e.longestSide>0&&!e.width&&!e.height&&(t.width>=t.height?e.width=e.longestSide:e.height=e.longestSide);const n={enableDevicePixelRatio:e.enableDevicePixelRatio,sx:0,sy:0,sw:t.width,sh:t.height,dx:0,dy:0,dw:e.width,dh:e.height};if(e.width>0){if(t.width<e.width&&!e.isForce){P({...t,raw:t},e,r);return}n.dh=t.height*e.width/t.width,e.height=n.dh}else{if(t.height<e.height&&!e.isForce){P({...t,raw:t},e,r);return}n.dw=t.width*e.height/t.height,e.width=n.dw}ce(t.element,t,e,n,r)}catch(n){i(n)}}function P(t,e,r){t.type!==e.mimeType?(t.type=e.mimeType,de(t.element,t.raw,e,{enableDevicePixelRatio:e.enableDevicePixelRatio,sx:0,sy:0,sw:t.width,sh:t.height,dx:0,dy:0,dw:t.width,dh:t.height},r)):r(t)}function ce(t,e,r,i,n){let s=e.width>e.height?e.width-i.dw:e.height-i.dh;if(s>r.perResize){const o=e.height/e.width;for(;s>r.perResize;)s-=r.perResize,i.sw=t.width,i.sh=t.height,i.dw=r.width+s,i.dh=i.dw*o,t=M(t,i)}i.sw=t.width,i.sh=t.height,i.dw=r.width,i.dh=r.height,de(t,e,r,i,n)}function de(t,e,r,i,n){const s=M(t,i),o=/^\w+\/\*$/.test(r.mimeType)||!r.mimeType?e.type:r.mimeType,c=s.toDataURL(o,r.quality),u=le(c,o);n({element:s,type:o,width:s.width,height:s.height,blob:u,data:c,url:oe(u),size:se(u.size),raw:e})}function rt(t,e){const{width:r,height:i}=t,{width:n,height:s}=e;let o;const c=i*n/s;if(r>c)o={sx:(r-c)/2,sy:0,sw:c,sh:i};else{const u=r*s/n;o={sx:0,sy:(i-u)/2,sw:r,sh:u}}return{...o,dx:0,dy:0,dw:n,dh:s}}function M(t,e){const r=e.enableDevicePixelRatio&&window.devicePixelRatio||1,i=Ke("canvas");i.width=e.dw*r,i.height=e.dh*r;const n=i.getContext("2d");return n.scale(r,r),n.drawImage(t,e.sx,e.sy,e.sw,e.sh,e.dx,e.dy,e.dw,e.dh),i}const it={imageMaxWidth:750,ignoreGif:!0,forceImageResize:!1,chooseFileMultiple:!0,chooseFileAccept:"image/*"};class nt extends Oe{constructor(r,i={}){let n=null;if(typeof r=="string"||r instanceof HTMLElement?n=x(r):(i=r||{},typeof i.container=="string"&&(n=x(i.container))),i={...it,...i},!n)throw new Error(`Can't found '${r}' Node in document!`);const s=m("div",{class:"zx-editor"});super({...i,container:s});g(this,"$el");g(this,"stylePanel");g(this,"toolbar");g(this,"fileInput",null);g(this,"_inputChangeHandler");n.append(s),this.$el=s,this.stylePanel=new je(i),this.use(this.stylePanel,this.$el),this.toolbar=new ke(i),this.use(this.toolbar,this.$el),this._inputChangeHandler=o=>{const c=o.currentTarget;this.handleImageFile(c.files).then(u=>{u.forEach(f=>{const l=/gif$/i.test(f.raw.type)&&i.ignoreGif;this.insert(`<img src="${l?f.raw.data:f.data}">`)})}).catch(u=>{this.emit("error",u)})},this.on("toolbarButtonClick",o=>{switch(o){case"choose-picture":if(typeof i.customPictureHandler=="function")i.customPictureHandler();else if(this.fileInput)this.fileInput.click();else{const c={type:"file",style:{display:"none"},accept:i.chooseFileAccept};i.chooseFileMultiple&&(c.multiple=!0),this.fileInput=m("input",c),this.$el.append(this.fileInput),this.fileInput.addEventListener("change",this._inputChangeHandler),this.fileInput.click()}break;case"text-style":this.stylePanel.show();break}})}handleImageFile(r){return r?new Promise((i,n)=>{Promise.all(v(r).map(this._handleFile)).then(s=>{i(s.sort((o,c)=>o.index-c.index).map(o=>o.data))}).catch(n)}):Promise.resolve([])}_handleFile(r,i){return new Promise((n,s)=>{et(r).then(o=>{n({data:o,index:i})}).catch(s)})}destroy(){var r;super.destroy(),this.stylePanel.destroy(),this.toolbar.destroy(),(r=this.fileInput)==null||r.removeEventListener("change",this._inputChangeHandler)}}const he=new nt({container:"#app"});window.editor=he;he.on("change",t=>{console.log(t)});
